{"version":2,"kind":"Notebook","sha256":"190d9aeb93a35b27583fd3ea9a42469fd14b1573269a0c9166bf2621d925135d","slug":"lecture-16-tech-details","location":"/lecture-16-tech-details.md","dependencies":[],"frontmatter":{"title":"Chapter 16: Technical Details: Boundary Conditions, Truncation of Interactions, Etc.","kernelspec":{"name":"python3","display_name":"comp-prob-solv","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.16.4"}},"content_includes_title":false,"authors":[{"id":"Robert B. Wexler","name":"Robert B. Wexler"}],"github":"https://github.com/wexlergroup/comp-prob-solv","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/wexlergroup/comp-prob-solv/blob/main/book/lecture-16-tech-details.md","thumbnail":"/pbc_2d_example_color-09975360f4e3e3c689d7fc1b3088abd4.png","exports":[{"format":"md","filename":"lecture-16-tech-details.md","url":"/lecture-16-tech-deta-47567a69ff5170207740c2c18ade1d88.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Learning Objectives","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"SqvUFX6c8a"}],"identifier":"learning-objectives","label":"Learning Objectives","html_id":"learning-objectives","implicit":true,"key":"yTlzzhGOmi"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"By the end of this lecture, you should be able to","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"meooObMN4D"}],"key":"Ff9gI1Meoe"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Explain the importance and implementation of periodic boundary conditions in molecular simulations.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"leIVkg0lLm"}],"key":"UGKfitwhM2"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Apply the minimum image convention to compute the shortest distance between particles under periodic boundary conditions.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"wyTXMvt1dA"}],"key":"FTGYhn260j"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Understand and implement interaction truncation methods, including the use of shift functions to handle discontinuities in potential energy functions.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"EXTpFh92LB"}],"key":"cFKhvmKWvb"}],"key":"ySjBYbTlQl"},{"type":"heading","depth":2,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Pp1swb8wEF"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"fQZDhtKYNl"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Simulating physical systems at the atomic or molecular level involves managing interactions among a vast number of particles. Directly simulating all these particles is computationally infeasible. To address this challenge, we use techniques such as ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"VpAJtxQM2l"},{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"periodic boundary conditions","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"uWWBWjIegw"}],"key":"MVjPfHi9b8"},{"type":"text","value":" and ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"b8ON9bQqy7"},{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"interaction truncation","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Y4i1bEQnc3"}],"key":"m1wYr16roi"},{"type":"text","value":" to make simulations manageable while still capturing essential physical behaviors.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"BhWRhZYzG7"}],"key":"WVAaiPOakn"},{"type":"heading","depth":2,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Periodic Boundary Conditions","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"F6drXsg4bx"}],"identifier":"periodic-boundary-conditions","label":"Periodic Boundary Conditions","html_id":"periodic-boundary-conditions","implicit":true,"key":"MY57tBwWRN"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Consider simulating a macroscopic amount of a substance, like a glass of water, at atomic-level precision. A typical glass contains about 250 mL of water. The number of atoms in such a volume can be estimated","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"DDnpSDcw1b"}],"key":"dayiWAJtlg"},{"type":"math","value":"\\begin{align*}\n\\text{Number of atoms} &= 250 \\, \\text{mL} \\times \\frac{1 \\, \\text{g}}{1 \\, \\text{mL}} \\times \\frac{1 \\, \\text{mol}}{18 \\, \\text{g}} \\times \\frac{6.022 \\times 10^{23} \\, \\text{molecules}}{1 \\, \\text{mol}} \\times \\frac{3 \\, \\text{atoms}}{1 \\, \\text{molecule}} \\\\\n&\\approx 2.5 \\times 10^{25} \\, \\text{atoms}.\n\\end{align*}","position":{"start":{"line":32,"column":1},"end":{"line":37,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext>Number of atoms</mtext></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>250</mn><mtext> </mtext><mtext>mL</mtext><mo>×</mo><mfrac><mrow><mn>1</mn><mtext> </mtext><mtext>g</mtext></mrow><mrow><mn>1</mn><mtext> </mtext><mtext>mL</mtext></mrow></mfrac><mo>×</mo><mfrac><mrow><mn>1</mn><mtext> </mtext><mtext>mol</mtext></mrow><mrow><mn>18</mn><mtext> </mtext><mtext>g</mtext></mrow></mfrac><mo>×</mo><mfrac><mrow><mn>6.022</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>23</mn></msup><mtext> </mtext><mtext>molecules</mtext></mrow><mrow><mn>1</mn><mtext> </mtext><mtext>mol</mtext></mrow></mfrac><mo>×</mo><mfrac><mrow><mn>3</mn><mtext> </mtext><mtext>atoms</mtext></mrow><mrow><mn>1</mn><mtext> </mtext><mtext>molecule</mtext></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>≈</mo><mn>2.5</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>25</mn></msup><mtext> </mtext><mtext>atoms</mtext><mi mathvariant=\"normal\">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\n\\text{Number of atoms} &amp;= 250 \\, \\text{mL} \\times \\frac{1 \\, \\text{g}}{1 \\, \\text{mL}} \\times \\frac{1 \\, \\text{mol}}{18 \\, \\text{g}} \\times \\frac{6.022 \\times 10^{23} \\, \\text{molecules}}{1 \\, \\text{mol}} \\times \\frac{3 \\, \\text{atoms}}{1 \\, \\text{molecule}} \\\\\n&amp;\\approx 2.5 \\times 10^{25} \\, \\text{atoms}.\n\\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.1957em;vertical-align:-1.8478em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.3478em;\"><span style=\"top:-4.3478em;\"><span class=\"pstrut\" style=\"height:3.4911em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">Number of atoms</span></span></span></span><span style=\"top:-2.3033em;\"><span class=\"pstrut\" style=\"height:3.4911em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8478em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.3478em;\"><span style=\"top:-4.3478em;\"><span class=\"pstrut\" style=\"height:3.4911em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">250</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">mL</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">mL</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">g</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">18</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">g</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">mol</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">mol</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">6.022</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">23</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">molecules</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">molecule</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">atoms</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.3033em;\"><span class=\"pstrut\" style=\"height:3.4911em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">2.5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">25</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">atoms</span></span><span class=\"mord\">.</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8478em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"PD3I1nGDzP"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Simulating this many atoms directly is beyond current computational capabilities. However, we can exploit the fact that many interactions are ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"x3UPpN4mwz"},{"type":"strong","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"short-ranged","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"bv6Oos66lf"}],"key":"JWLfDg1dar"},{"type":"text","value":", decaying rapidly with distance. This allows us to simulate a smaller, representative system (typically between ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"b0YljWfgoB"},{"type":"span","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"10","key":"spNJR32NDz"},{"type":"superscript","children":[{"type":"text","value":"3","key":"UWJIcBQRGB"}],"key":"e9TRPnZWGi"}],"key":"b5WnXGzhq1"},{"type":"text","value":" and ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"myk7ICrQPz"},{"type":"span","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"10","key":"ZTmvXfVQ88"},{"type":"superscript","children":[{"type":"text","value":"9","key":"GD3QcpVYDz"}],"key":"IxvJXIjuiD"}],"key":"kre3wc2QTk"},{"type":"text","value":" atoms) by applying ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"Yglg8kSnkl"},{"type":"strong","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"periodic boundary conditions (PBCs)","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"QubBHFhWnU"}],"key":"ltVCN73HK6"},{"type":"text","value":".","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"pKTxlEYrSZ"}],"key":"zMCuI0eHNL"},{"type":"heading","depth":3,"position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Concept of Periodic Boundary Conditions","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"DpOmOjle0H"}],"identifier":"concept-of-periodic-boundary-conditions","label":"Concept of Periodic Boundary Conditions","html_id":"concept-of-periodic-boundary-conditions","implicit":true,"key":"uMBCPaBF7T"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"PBCs mimic an infinite system by repeating a finite simulation box in all spatial directions. Each particle interacts not only with other particles within the box but also with the periodic images of particles in neighboring boxes. This setup eliminates surface effects that would otherwise arise from the finite size of the simulation box.","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"cK7hYuLeMp"}],"key":"rIu23fXNLL"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"For example, in two dimensions:","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"fLYut16QHA"}],"key":"LIk1vRGsPX"},{"type":"image","url":"/pbc_2d_example_color-09975360f4e3e3c689d7fc1b3088abd4.png","alt":"Periodic boundary conditions","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"BCxBHSSyC8","urlSource":"pbc_2d_example_colored.png"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"s9evMOnMvU"},{"type":"strong","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"central box","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"bZV6y0E3fD"}],"key":"BNlI9TCLz6"},{"type":"text","value":" is the simulation box and the ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"fJylwUk4ve"},{"type":"strong","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"surrounding boxes","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"AKt5mBTqP2"}],"key":"TFtLDRwleW"},{"type":"text","value":" are periodic images. When a particle moves out of the simulation box, it re-enters from the opposite side, maintaining a constant number of particles.","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"m0oeIxg5Pl"}],"key":"pcsPrwBvbD"},{"type":"heading","depth":2,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"Minimum Image Convention","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"haF2t8riXB"}],"identifier":"minimum-image-convention","label":"Minimum Image Convention","html_id":"minimum-image-convention","implicit":true,"key":"pXGfSkDn4e"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"When using PBCs, calculating distances between particles requires careful consideration to ensure interactions are computed correctly. Simply using positions within the simulation box might not yield the shortest distance due to periodic images.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"XIqzcSY7do"}],"key":"t0PjKN9SW8"},{"type":"heading","depth":3,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Calculating the Minimum Image Distance","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"LlOz4gqX5j"}],"identifier":"calculating-the-minimum-image-distance","label":"Calculating the Minimum Image Distance","html_id":"calculating-the-minimum-image-distance","implicit":true,"key":"WIdoQLOKQF"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Pk8UdocupP"},{"type":"strong","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"minimum image convention","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"TrbVBLZBHO"}],"key":"l2lBuTd7Un"},{"type":"text","value":" states that the distance between two particles should be the shortest distance considering all periodic images. For a box with edge length ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"TU3UAOMiGm"},{"type":"inlineMath","value":"L","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"qcLUbNoVv8"},{"type":"text","value":", the minimum image distance ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"hbaQ2q0zN6"},{"type":"inlineMath","value":"\\Delta \\mathbf{r}","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi mathvariant=\"bold\">r</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta \\mathbf{r}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathbf\">r</span></span></span></span>","key":"gtF0mT4e0t"},{"type":"text","value":" between particles at positions ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"EK5crMYP0e"},{"type":"inlineMath","value":"\\mathbf{r}_1","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">r</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{r}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PESLDkrC3Y"},{"type":"text","value":" and ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"oqzpDoL2Xu"},{"type":"inlineMath","value":"\\mathbf{r}_2","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">r</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{r}_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"LuUzcqigS2"},{"type":"text","value":" is","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"yalmIgvp13"}],"key":"iBrr7eO8lo"},{"type":"math","value":"\\Delta \\mathbf{r} = \\mathbf{r}_1 - \\mathbf{r}_2 - L \\cdot \\text{round}\\left(\\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{L}\\right),","position":{"start":{"line":59,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi mathvariant=\"bold\">r</mi><mo>=</mo><msub><mi mathvariant=\"bold\">r</mi><mn>1</mn></msub><mo>−</mo><msub><mi mathvariant=\"bold\">r</mi><mn>2</mn></msub><mo>−</mo><mi>L</mi><mo>⋅</mo><mtext>round</mtext><mrow><mo fence=\"true\">(</mo><mfrac><mrow><msub><mi mathvariant=\"bold\">r</mi><mn>1</mn></msub><mo>−</mo><msub><mi mathvariant=\"bold\">r</mi><mn>2</mn></msub></mrow><mi>L</mi></mfrac><mo fence=\"true\">)</mo></mrow><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\Delta \\mathbf{r} = \\mathbf{r}_1 - \\mathbf{r}_2 - L \\cdot \\text{round}\\left(\\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{L}\\right),</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathbf\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mord text\"><span class=\"mord\">round</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"2","key":"g8zk8fvNHU"},{"type":"paragraph","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"Gsda0ckSLP"},{"type":"inlineMath","value":"\\text{round}","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>round</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{round}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">round</span></span></span></span></span>","key":"l4aNN7MBoV"},{"type":"text","value":" operates element-wise on vector components, rounding to the nearest integer. This formula maps the displacement vector into the range ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"qLXBirPdZu"},{"type":"inlineMath","value":"\\left(-\\frac{L}{2}, \\frac{L}{2}\\right]","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\">(</mo><mo>−</mo><mfrac><mi>L</mi><mn>2</mn></mfrac><mo separator=\"true\">,</mo><mfrac><mi>L</mi><mn>2</mn></mfrac><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\left(-\\frac{L}{2}, \\frac{L}{2}\\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2223em;vertical-align:-0.35em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8723em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8723em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span></span></span></span>","key":"XFaVi5LYnK"},{"type":"text","value":", ensuring it corresponds to the minimum image.","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"Y4rU1pDfSZ"}],"key":"qNZjCfORjm"},{"type":"heading","depth":4,"position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"Implementation of the Minimum Image Convention in Python","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"yvmIsi80RR"}],"identifier":"implementation-of-the-minimum-image-convention-in-python","label":"Implementation of the Minimum Image Convention in Python","html_id":"implementation-of-the-minimum-image-convention-in-python","implicit":true,"key":"nCcfW2E9dU"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Let’s implement the minimum image convention in Python for a two-dimensional system.","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"ynYN4k0Pz7"}],"key":"wqmvYF8xCP"}],"key":"OQgRxMfUCf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\n\ndef minimum_image_distance(p1, p2, box_size):\n    \"\"\"\n    Compute the minimum image distance between two particles p1 and p2\n    under periodic boundary conditions in a 2D box.\n\n    Parameters:\n    p1, p2 : np.ndarray\n        Coordinates of the two particles (2D vectors).\n    box_size : float\n        Length of the simulation box edge.\n\n    Returns:\n    float\n        Minimum image distance between p1 and p2.\n    \"\"\"\n    delta = p1 - p2\n    # Apply minimum image convention\n    delta -= box_size * np.round(delta / box_size)\n    distance = np.linalg.norm(delta)\n    return distance\n\n# Define the box size\nbox_size = 10.0\n\n# Define positions of the particles\nblue_particle = np.array([2.0, 8.0])   # Coordinates of the blue particle\ncyan_particle = np.array([9.0, 9.0])   # Coordinates of the cyan particle\n\n# Calculate the minimum image distance\ndistance = minimum_image_distance(blue_particle, cyan_particle, box_size)\nprint(f\"The minimum image distance between the blue and cyan particles is {distance:.2f} units.\")","key":"f2vtKD10vy"},{"type":"output","id":"12OzKOtNwu9uy-U6E0q-6","data":[],"key":"LtN3N0Oqbs"}],"key":"kA4IUUjPwA"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Explanation","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"PlH0slYUb9"}],"key":"GcFolCSZ0R"},{"type":"paragraph","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"inlineCode","value":"delta","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"Z1J92futhu"},{"type":"text","value":" calculates the displacement vector between the two particles. The minimum image convention adjusts this displacement to ensure it corresponds to the shortest distance under periodic boundary conditions. The Euclidean norm of the adjusted displacement gives the minimum image distance.","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"ZPnmnP3LXD"}],"key":"zw4slNaHmQ"}],"class":"dropdown","key":"mrspud0oq9"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"DNWiuDww2w"}],"key":"gPAPvLTnQX"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"This implementation assumes a cubic (or square in 2D) simulation box with equal edge lengths and right angles.","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"eDvK8WRxob"}],"key":"kXxCuACj5e"}],"key":"P1mKE1HVAt"},{"type":"heading","depth":2,"position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"Truncation of Interactions","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"wmDO3gEQpA"}],"identifier":"truncation-of-interactions","label":"Truncation of Interactions","html_id":"truncation-of-interactions","implicit":true,"key":"eGm5hgh2Cz"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"In many-body simulations, the computational cost of calculating interactions scales as ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"Z1u0rxx8XB"},{"type":"inlineMath","value":"\\mathcal{O}(N^2)","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{O}(N^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"kFtppKEDbe"},{"type":"text","value":". To make simulations feasible, especially for large ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"ZWh3FRtC5p"},{"type":"inlineMath","value":"N","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"rAlVOQgb9R"},{"type":"text","value":", we often ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"pFfNI9khAv"},{"type":"strong","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"truncate interactions","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"bW2qSaYQ8Z"}],"key":"paNVRP9owV"},{"type":"text","value":" by introducing a cutoff distance ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"Lu91yHFVI2"},{"type":"inlineMath","value":"r_c","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">r_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XfUv2HyxUM"},{"type":"text","value":", beyond which interactions are neglected.","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"qZ2zcjzyO2"}],"key":"JwzDKksJy1"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Minimum Image Convention, Truncated Interactions, and Box Size","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"NgmOQuhLdQ"}],"key":"kxwnj0H1B1"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"When using the minimum image convention with truncated interactions, the box size should be chosen such that the cutoff distance ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"hjNdqiZPZu"},{"type":"inlineMath","value":"r_c","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">r_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ytULIsniu8"},{"type":"text","value":" is less than half the box size. This ensures that the minimum image distance is always within the cutoff range.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"DJo3R5u3a9"}],"key":"IGC4hvRzKf"}],"class":"warning","key":"QIHb2oxqfR"},{"type":"heading","depth":3,"position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Potential Energy Truncation","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"QRdCDNBigS"}],"identifier":"potential-energy-truncation","label":"Potential Energy Truncation","html_id":"potential-energy-truncation","implicit":true,"key":"SKhf1JOs9k"},{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Consider the Lennard-Jones potential, describing the interaction between a pair of neutral atoms or molecules","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"OcuANWcVAr"}],"key":"Beipzk9nW5"},{"type":"math","value":"U(r) = 4\\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right],","position":{"start":{"line":127,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>U</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>4</mn><mi>ε</mi><mrow><mo fence=\"true\">[</mo><msup><mrow><mo fence=\"true\">(</mo><mfrac><mi>σ</mi><mi>r</mi></mfrac><mo fence=\"true\">)</mo></mrow><mn>12</mn></msup><mo>−</mo><msup><mrow><mo fence=\"true\">(</mo><mfrac><mi>σ</mi><mi>r</mi></mfrac><mo fence=\"true\">)</mo></mrow><mn>6</mn></msup><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">U(r) = 4\\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right],</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\">ε</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.354em;\"><span style=\"top:-3.6029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.354em;\"><span style=\"top:-3.6029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"3","key":"tfHdLjlA1Q"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"aKoZ79H6C1"},{"type":"inlineMath","value":"U(r)","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">U(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"gTzizaB1yB"},{"type":"text","value":" is the potential energy as a function of distance ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"ciVwNZ5CHX"},{"type":"inlineMath","value":"r","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"V2t8vfiqLF"},{"type":"text","value":", ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"ja0NF9w5Dp"},{"type":"inlineMath","value":"\\varepsilon","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">\\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span>","key":"KTXRoN22IN"},{"type":"text","value":" is the depth of the potential well (energy scale), and ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"Y85zaXsZuf"},{"type":"inlineMath","value":"\\sigma","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"w1yOskUS0e"},{"type":"text","value":" is the finite distance at which the interparticle potential is zero (length scale). Truncating this potential at ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"OymwAU7SJi"},{"type":"inlineMath","value":"r_c","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">r_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BgnvOn1oHz"},{"type":"text","value":" sets ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"k1tSSCDKzl"},{"type":"inlineMath","value":"U(r) = 0","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">U(r) = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"Pm3T6yzJkB"},{"type":"text","value":" for ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"jCR4Zrb3cx"},{"type":"inlineMath","value":"r \\geq r_c","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>≥</mo><msub><mi>r</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">r \\geq r_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"qqiyLZNy3t"},{"type":"text","value":", but introduces a discontinuity at ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"WBJBpNucTP"},{"type":"inlineMath","value":"r = r_c","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><msub><mi>r</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">r = r_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"fbJCDIhrfs"},{"type":"text","value":", leading to non-physical forces due to the abrupt change.","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"dTULi9hTkd"}],"key":"VHRoFW93Dt"},{"type":"image","url":"/lennard_jones_with_c-fb91c4c0dc03e019d2c3e2aba397cf42.png","alt":"Truncation of interactions","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"lWr3O0gxnJ","urlSource":"lennard_jones_with_cutoff_and_shift_inset.png"},{"type":"heading","depth":3,"position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"Shift Function to Smooth the Potential","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"iZICGY3J1k"}],"identifier":"shift-function-to-smooth-the-potential","label":"Shift Function to Smooth the Potential","html_id":"shift-function-to-smooth-the-potential","implicit":true,"key":"uMwaxXiCVV"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"To mitigate the discontinuity, we can use a ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"OLkK9DZE2l"},{"type":"strong","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"shifted potential","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"d9lj7vpWYV"}],"key":"aWNIZWLjoq"},{"type":"text","value":" ensuring the potential energy smoothly approaches zero at ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"Q8xhIbX82f"},{"type":"inlineMath","value":"r_c","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">r_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"QduGpbuYUz"}],"key":"lQXvtGvvoV"},{"type":"math","value":"U_{\\text{shifted}}(r) = \\begin{cases}\nU(r) - U(r_c) & \\text{if } r < r_c, \\\\\n0 & \\text{if } r \\geq r_c.\n\\end{cases}","position":{"start":{"line":139,"column":1},"end":{"line":144,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>U</mi><mtext>shifted</mtext></msub><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.36em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>U</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>U</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>c</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>if </mtext><mi>r</mi><mo>&lt;</mo><msub><mi>r</mi><mi>c</mi></msub><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>if </mtext><mi>r</mi><mo>≥</mo><msub><mi>r</mi><mi>c</mi></msub><mi mathvariant=\"normal\">.</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">U_{\\text{shifted}}(r) = \\begin{cases}\nU(r) - U(r_c) &amp; \\text{if } r &lt; r_c, \\\\\n0 &amp; \\text{if } r \\geq r_c.\n\\end{cases}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">shifted</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">if </span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">if </span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"4","key":"VHh6OJfg3L"},{"type":"paragraph","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"By subtracting ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"zH1jhqQPFt"},{"type":"inlineMath","value":"U(r_c)","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>c</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">U(r_c)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"pxzQmZAgEU"},{"type":"text","value":", we ensure ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"OsIdyx12Gs"},{"type":"inlineMath","value":"U_{\\text{shifted}}(r_c) = 0","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mtext>shifted</mtext></msub><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>c</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">U_{\\text{shifted}}(r_c) = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">shifted</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"fA94ZRbB3Q"},{"type":"text","value":", eliminating the discontinuity in potential energy.","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"W5amni0gTU"}],"key":"ITds6OvjIZ"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"RqxQ5IKnc0"}],"key":"ZevgfyLNhs"},{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"While the shift function removes the discontinuity in potential energy at ","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"p75tUHWKtU"},{"type":"inlineMath","value":"r = r_c","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><msub><mi>r</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">r = r_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"mT7dUqRlhz"},{"type":"text","value":", it does not eliminate the discontinuity in the force (the derivative of the potential). This can still lead to artifacts in simulations, especially affecting dynamical properties.","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"fkb42tsX0k"}],"key":"qKCmh4NANN"}],"key":"RgzI0D9sWm"},{"type":"heading","depth":4,"position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"text","value":"Implementation of a Shifted Lennard-Jones Potential in Python","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"sxqNBc9Kar"}],"identifier":"implementation-of-a-shifted-lennard-jones-potential-in-python","label":"Implementation of a Shifted Lennard-Jones Potential in Python","html_id":"implementation-of-a-shifted-lennard-jones-potential-in-python","implicit":true,"key":"ZYp8DsHSZm"},{"type":"paragraph","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"text","value":"Implementing the shifted Lennard-Jones potential:","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"qtCSt7sN81"}],"key":"BlXBDZM2jO"},{"type":"code","lang":"python","value":"def lennard_jones(r, epsilon, sigma):\n    \"\"\"\n    Compute the Lennard-Jones potential energy between two particles\n    at distance r.\n\n    Parameters:\n    r : float or np.ndarray\n        Distance between the two particles.\n    epsilon : float\n        Depth of the potential well.\n    sigma : float\n        Finite distance at which the interparticle potential is zero.\n\n    Returns:\n    float or np.ndarray\n        Potential energy between the two particles.\n    \"\"\"\n    sr6 = (sigma / r) ** 6\n    return 4 * epsilon * (sr6 ** 2 - sr6)\n\ndef lennard_jones_shifted(r, epsilon, sigma, r_c):\n    \"\"\"\n    Compute the shifted Lennard-Jones potential energy between two particles\n    at distance r.\n\n    Parameters:\n    r : float or np.ndarray\n        Distance between the two particles.\n    epsilon : float\n        Depth of the potential well.\n    sigma : float\n        Finite distance at which the interparticle potential is zero.\n    r_c : float\n        Cutoff distance.\n\n    Returns:\n    float or np.ndarray\n        Shifted potential energy between the two particles.\n    \"\"\"\n    if r < r_c:\n        U = lennard_jones(r, epsilon, sigma)\n        U_c = lennard_jones(r_c, epsilon, sigma)\n        return U - U_c\n    else:\n        return 0.0\n\n# Parameters for the Lennard-Jones potential\nepsilon = 1.0    # Energy units\nsigma = 1.0      # Distance units\nr_c = 2.5 * sigma  # Cutoff distance\n\n# Example calculation\nr = 2.0  # Distance between particles\nenergy_shifted = lennard_jones_shifted(r, epsilon, sigma, r_c)\nenergy_original = lennard_jones(r, epsilon, sigma)\n\nprint(f\"At distance r = {r}, the shifted Lennard-Jones potential energy is {energy_shifted:.4f}.\")\nprint(f\"Without shifting, the Lennard-Jones potential energy is {energy_original:.4f}.\")","position":{"start":{"line":156,"column":1},"end":{"line":215,"column":1}},"key":"Gk0hZ1ycNT"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Explanation","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"jBc0hMFmJJ"}],"key":"slNOzylNx6"},{"type":"paragraph","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"STXyrCy8Ye"},{"type":"inlineCode","value":"lennard_jones","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"enmQ3SuU6Y"},{"type":"text","value":" function calculates the standard Lennard-Jones potential energy ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"jcK42q6xTq"},{"type":"inlineMath","value":"U(r)","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">U(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"WjCmw6R5je"},{"type":"text","value":", while ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"PP3COVWSzk"},{"type":"inlineCode","value":"lennard_jones_shifted","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"ebnCRhJvJX"},{"type":"text","value":" computes the shifted potential energy ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"qQd3stas6Z"},{"type":"inlineMath","value":"U_{\\text{shifted}}(r)","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mtext>shifted</mtext></msub><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">U_{\\text{shifted}}(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">shifted</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"HoGApZEjgS"},{"type":"text","value":" by subtracting ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"J7tdCfaYwN"},{"type":"inlineMath","value":"U(r_c)","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>c</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">U(r_c)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"S5jKe44Ce7"},{"type":"text","value":" when ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"zio6jVS8Ej"},{"type":"inlineMath","value":"r < r_c","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>&lt;</mo><msub><mi>r</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">r &lt; r_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NUbMiOjHMI"},{"type":"text","value":". The cutoff handling ensures ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"U00RzICa2a"},{"type":"inlineMath","value":"U_{\\text{shifted}}(r) = 0","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mtext>shifted</mtext></msub><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">U_{\\text{shifted}}(r) = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">shifted</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"fzpu9gL0Ya"},{"type":"text","value":" when ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"VP61pHHGIi"},{"type":"inlineMath","value":"r \\geq r_c","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>≥</mo><msub><mi>r</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">r \\geq r_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GpKeGEUVdx"},{"type":"text","value":".","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"iZXL3vNODk"}],"key":"wf5XJ4wEvU"}],"class":"dropdown","key":"DQOLffEnZ4"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"oaZylkUb6w"}],"key":"UH64nIQAbO"},{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"To further smooth the potential and its derivatives, methods like force shifting or spline smoothing can be employed.","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"l7UHwkIRy4"}],"key":"nP4OdoCGVw"}],"key":"pArAPFqyfY"},{"type":"heading","depth":2,"position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"HeHXt7zkIP"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"rVWs9xPr4d"},{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"In this lecture, we explored key technical details essential for efficient and accurate molecular simulations:","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"F5oSo5I77B"}],"key":"X3OIPX70oj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":230,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"strong","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"text","value":"Periodic Boundary Conditions (PBCs):","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"wdGodymrqo"}],"key":"eEQxngab3L"},{"type":"text","value":" Simulate infinite systems by repeating a finite simulation box, reducing finite-size effects.","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"bC2EMb4KiI"}],"key":"PIlNmxfvfV"},{"type":"listItem","spread":true,"position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"strong","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"text","value":"Minimum Image Convention:","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"TzV3e1twWW"}],"key":"FmlYUXY6Oj"},{"type":"text","value":" Calculate the shortest distance between particles under PBCs by considering the closest periodic image.","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"W0dnV4PLGW"}],"key":"uUz8QqQ87L"},{"type":"listItem","spread":true,"position":{"start":{"line":232,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"strong","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"children":[{"type":"text","value":"Truncation of Interactions:","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"dSDx4BoRXj"}],"key":"E2ki6jKGEP"},{"type":"text","value":" Limit the range of interactions to a cutoff distance to reduce computational cost, and address discontinuities introduced by truncation using shift functions.","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"YYbVg0GUHi"}],"key":"e96GDKB9xq"}],"key":"scB1qcLUja"},{"type":"paragraph","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"Understanding and correctly implementing these concepts are crucial for simulating large systems while maintaining computational efficiency and physical accuracy.","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"H34NUcHXIw"}],"key":"iS15sJRT7p"}],"key":"nNlvzM4NW4"}],"key":"v27tsGkODY"},"references":{"cite":{"order":[],"data":{}}}}