{"version":2,"kind":"Notebook","sha256":"405a229bd5689d3e4d9c2c89b530ca3f8a37d4c86099e0239ae9d6489cb2bfdc","slug":"lecture-18-adsorption","location":"/lecture-18-adsorption.md","dependencies":[],"frontmatter":{"title":"Chapter 18: Monte Carlo Simulations of Adsorption on Surfaces","kernelspec":{"name":"python3","display_name":"comp-prob-solv","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.16.4"}},"content_includes_title":false,"authors":[{"id":"Robert B. Wexler","name":"Robert B. Wexler"}],"github":"https://github.com/wexlergroup/comp-prob-solv","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/wexlergroup/comp-prob-solv/blob/main/book/lecture-18-adsorption.md","exports":[{"format":"md","filename":"lecture-18-adsorption.md","url":"/lecture-18-adsorptio-966c0b673ba31d9a037e5168d3ea7544.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Learning Objectives","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Y6PbhzxzNE"}],"identifier":"learning-objectives","label":"Learning Objectives","html_id":"learning-objectives","implicit":true,"key":"S7wzCBqRD3"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"By the end of this lecture, you should be able to","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"tednhI4nJ3"}],"key":"dV1I78Wuad"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Describe the concept of adsorption and its importance in surface science.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"nIu7Z3BYCG"}],"key":"biW4DJmQTH"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Implement a Monte Carlo simulation to study adsorption on surfaces.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"L2v463kowo"}],"key":"CPKGJelEQ7"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Analyze the results of a Monte Carlo simulation to determine the adsorption isotherm.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"SIjuxF1LnD"}],"key":"RFrwm7tjtv"}],"key":"q1YDVkhg1r"},{"type":"heading","depth":2,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"fU6x5Qy4Zk"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"MzP00Zlue3"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Adsorption is the process by which molecules or atoms adhere to the surface of a solid or liquid. It plays a crucial role in various applications, such as catalysis, gas separation, and drug delivery. In this project, we will explore how to simulate adsorption on solid surfaces using Monte Carlo methods.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"f9uHzsE1RB"}],"key":"x3YUSIEWxd"},{"type":"heading","depth":2,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Adsorption on Surfaces","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"r9ANepZpzm"}],"identifier":"adsorption-on-surfaces","label":"Adsorption on Surfaces","html_id":"adsorption-on-surfaces","implicit":true,"key":"oiKc9khSHB"},{"type":"heading","depth":3,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Types of Adsorption","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"Y7fJQFSn4Y"}],"identifier":"types-of-adsorption","label":"Types of Adsorption","html_id":"types-of-adsorption","implicit":true,"key":"NcHPkkBK0m"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Adsorption on surfaces can be classified into three main types:","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"xpFfEHKyo5"}],"key":"oTdWFLG2r5"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":34,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"strong","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Physisorption","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"EnsA5DL6bg"}],"key":"Z7qmZ5Io6u"},{"type":"text","value":": In physisorption, molecules are held to the surface by weak van der Waals forces. This type of adsorption is reversible and does not involve the formation of chemical bonds between the adsorbate and the surface.","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"ezEy6SqX0r"}],"key":"Kicdp9KBDY"}],"key":"W7EF8TW68x"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"strong","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Chemisorption","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"ItSsZX8lRA"}],"key":"TxqbPCEYyB"},{"type":"text","value":": Chemisorption involves the formation of chemical bonds between the adsorbate and the surface. This type of adsorption is stronger than physisorption and can lead to irreversible changes in the adsorbate.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"dvUOjtjv0O"}],"key":"VYDiTwWrLB"}],"key":"HzlAL2caJl"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"strong","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Dissociative Adsorption","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"AgNveRf5fC"}],"key":"tU9wT4T4fK"},{"type":"text","value":": In dissociative adsorption, the adsorbate molecule dissociates into atoms or radicals upon adsorption. This process is common for molecules like hydrogen and oxygen on metal surfaces.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"sPwCzysxvf"}],"key":"ovJaPtngr2"}],"key":"BcLiTCK25Z"}],"key":"jRV7sW40s1"},{"type":"heading","depth":3,"position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Adsorption Isotherms","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"S9kRvSyrFQ"}],"identifier":"adsorption-isotherms","label":"Adsorption Isotherms","html_id":"adsorption-isotherms","implicit":true,"key":"W0tecx4HMN"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"The adsorption isotherm is a plot of the amount of adsorbate adsorbed on the surface as a function of pressure or concentration at constant temperature. The shape of the isotherm provides information about the adsorption mechanism and the surface properties.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"N3Ltr5HE2H"}],"key":"LGTIlhTl31"},{"type":"heading","depth":2,"position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Lattice Gas Model","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"vfGar91pO7"}],"identifier":"lattice-gas-model","label":"Lattice Gas Model","html_id":"lattice-gas-model","implicit":true,"key":"Ml6Wi2o014"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"In the lattice gas model, we represent the surface as a 2D lattice where each lattice site can be occupied by an adsorbate molecule. The adsorbate molecules interact with each other and with the surface through pairwise interactions. The energy of the system is given by the sum of these pairwise interactions.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"SHYAKqIPbt"}],"key":"Lgp2bFYvgz"},{"type":"heading","depth":3,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Ideal Sorbent","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"bEk8vrsP3W"}],"identifier":"ideal-sorbent","label":"Ideal Sorbent","html_id":"ideal-sorbent","implicit":true,"key":"x28JBb66Qz"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"In this model system, ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"FhYXus77Yb"},{"type":"inlineMath","value":"N_s","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>s</mi></msub></mrow><annotation encoding=\"application/x-tex\">N_s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZnYh57gjMZ"},{"type":"text","value":" sorbent particles interact with ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"zQEUh80wH2"},{"type":"inlineMath","value":"N_a","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>a</mi></msub></mrow><annotation encoding=\"application/x-tex\">N_a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"n0lsVRFETS"},{"type":"text","value":" adsorption sites on a solid surface but do not interact with each other.","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"xt04rd36J6"}],"key":"Qyal4Y2dbV"}],"key":"Vn8LfbaqF2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport numpy as np\n\n# Define grid size\ngridsize = 4\n\n# Create figure and axis\nfig, ax = plt.subplots()\n\n# Create gridlines\nax.set_xticks(np.arange(0, gridsize + 1, 1))\nax.set_yticks(np.arange(0, gridsize + 1, 1))\nax.grid(True)\n\n# Set the limits of the plot\nax.set_xlim(0, gridsize)\nax.set_ylim(0, gridsize)\n\n# Label adsorption sites\nfor x in range(gridsize):\n    for y in range(gridsize):\n        ax.text(x + 0.5, y + 0.5, 'A', ha='center', va='center')\n\n# Define sorbent particles' positions\nsorbent_positions = [(0.5, 0.5), (2.5, 0.5), (1.5, 1.5), (3.5, 1.5), (0.5, 2.5)]\n\n# Plot sorbent particles\nfor (x, y) in sorbent_positions:\n    ax.plot(x, y, 'o', color='blue', markersize=15, zorder=10)\n\n# Add labels for N_s and N_a\nax.text(2, -0.5, r'$N_a = 4 \\times 4 = 16$ adsorption sites', ha='center')\nax.text(2, 4.5, r'$N_s = 5$ sorbent particles', color='blue', ha='center')\n\n# Hide ticks\nax.set_xticklabels([])\nax.set_yticklabels([])\n\n# Show plot\nplt.gca().set_aspect('equal', adjustable='box')\nplt.show()","visibility":"hide","key":"mERVoL65Wg"},{"type":"output","id":"naAa5F9AVi00bPD7466mV","data":[],"visibility":"show","key":"dvV7nGmWlH"}],"data":{"tags":[]},"visibility":"show","key":"G1swniLFzT"},{"type":"block","children":[{"type":"aside","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"m8wUQWwTIP"}],"key":"KaKSYbs3HM"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"A square lattice can be used to represent the (100) surface of face-centered cubic solids like the alkali metals Ca and Sr, group nine transition metals Rh and Ir, group ten transition metals (Ni, Pd, and Pt), group eleven transition metals (Cu, Ag, and Au), Al, and Pb.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"zTK2eiKccF"}],"key":"MnxA7ZfeNH"}],"key":"uonsVfldtR"}],"key":"ixhtmwIVT6"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"The figure above shows an example of an ideal sorbent system with ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"Au1vbv5wZO"},{"type":"inlineMath","value":"N_s = 5","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>s</mi></msub><mo>=</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">N_s = 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"RJkbE9yfMw"},{"type":"text","value":" sorbent particles and ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"CIVy7Pn8De"},{"type":"inlineMath","value":"N_a = 16","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>a</mi></msub><mo>=</mo><mn>16</mn></mrow><annotation encoding=\"application/x-tex\">N_a = 16</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">16</span></span></span></span>","key":"zFLB2XfvNj"},{"type":"text","value":" adsorption sites on a ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"zlgfz2wrSY"},{"type":"inlineMath","value":"4 \\times 4","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4 \\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"BFbVmqvE9e"},{"type":"text","value":" square lattice. The sorbent particles are represented by blue circles, and the adsorption sites are labeled with the letter “A.”","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"tmgPeU1WRx"}],"key":"nRGAN2mwyz"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"In Lecture 11, we showed that the coverage of the surface by the sorbent particles can then be calculated as","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"p0Sz7Xph3d"}],"key":"J5UfESFiRp"},{"type":"math","value":"\\theta = \\frac{e^{-\\beta (\\epsilon - \\mu)}}{1 + e^{-\\beta (\\epsilon - \\mu)}}","position":{"start":{"line":107,"column":1},"end":{"line":109,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>θ</mi><mo>=</mo><mfrac><msup><mi>e</mi><mrow><mo>−</mo><mi>β</mi><mo stretchy=\"false\">(</mo><mi>ϵ</mi><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>β</mi><mo stretchy=\"false\">(</mo><mi>ϵ</mi><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\theta = \\frac{e^{-\\beta (\\epsilon - \\mu)}}{1 + e^{-\\beta (\\epsilon - \\mu)}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3523em;vertical-align:-0.7873em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.565em;\"><span style=\"top:-2.296em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">ϵ</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">μ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">ϵ</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">μ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7873em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"voJcBz4qLD"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"wVtJnEuxsi"},{"type":"inlineMath","value":"\\epsilon","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"bgS5gkKElr"},{"type":"text","value":" is the interaction energy between the sorbent particles and the surface, ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"SB2gwO7ONU"},{"type":"inlineMath","value":"\\mu","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span>","key":"F4654Vc85d"},{"type":"text","value":" is the chemical potential of the sorbent particles, and ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"MucqwVw8XW"},{"type":"inlineMath","value":"\\beta = \\frac{1}{k_{\\rm B} T}","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mi>k</mi><mi mathvariant=\"normal\">B</mi></msub><mi>T</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\beta = \\frac{1}{k_{\\rm B} T}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2904em;vertical-align:-0.4453em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3567em;margin-left:-0.0315em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">B</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1433em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4453em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"Se71riin0Y"},{"type":"text","value":".","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"ylkf5P813D"}],"key":"ZYM4VqP8Ja"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Interpretation of Chemical Potential","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"AVR3A1hRXg"}],"key":"hNUSuoanj4"},{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"The chemical potential ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"YsXaYrhtN6"},{"type":"inlineMath","value":"\\mu","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span>","key":"x4EmfVXpGu"},{"type":"text","value":" can be interpreted as the energy change when a sorbent particle is added to the system from a reservoir at constant temperature. A positive chemical potential indicates that the sorbent particles are more likely to adsorb on the surface, while a negative chemical potential indicates that the sorbent particles are more likely to desorb from the surface.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"ceXa2ZSPsS"}],"key":"MzQxErCCzc"}],"class":"tip","key":"LhUgmi1czE"},{"type":"heading","depth":3,"position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"Sorbent with Mean-Field Interactions","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"QTdTAs7GiM"}],"identifier":"sorbent-with-mean-field-interactions","label":"Sorbent with Mean-Field Interactions","html_id":"sorbent-with-mean-field-interactions","implicit":true,"key":"HdbvTSJJfy"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"In a more realistic model, we can introduce mean-field interactions between the sorbent particles. The mean-field interaction energy between one sorbent particle and all other sorbent particles can be set to a constant value. This interaction energy can be used to model the attractive or repulsive interactions between the sorbent particles.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"NYnH8BJYDi"}],"key":"qFX5DcExQN"}],"key":"EVqXTF4wU3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport numpy as np\n\n# Define grid size\ngridsize = 4\n\n# Create figure and axis\nfig, ax = plt.subplots()\n\n# Create gridlines\nax.set_xticks(np.arange(0, gridsize + 1, 1))\nax.set_yticks(np.arange(0, gridsize + 1, 1))\nax.grid(True)\n\n# Set the limits of the plot\nax.set_xlim(0, gridsize)\nax.set_ylim(0, gridsize)\n\n# Label adsorption sites\nfor x in range(gridsize):\n    for y in range(gridsize):\n        ax.text(x + 0.5, y + 0.5, 'A', ha='center', va='center')\n\n# Define sorbent particles' positions\nsorbent_positions = [(0.5, 0.5), (2.5, 0.5), (1.5, 1.5), (3.5, 1.5), (0.5, 2.5)]\n\n# Plot sorbent particles\nfor (x, y) in sorbent_positions:\n    ax.plot(x, y, 'o', color='blue', markersize=15, zorder=10)\n\n# Mean-field interaction arrows (red lines)\nfor (x1, y1) in sorbent_positions:\n    for (x2, y2) in sorbent_positions:\n        ax.arrow(x1, y1, x2 - x1, y2 - y1, head_width=0.1, head_length=0.1, fc='red', ec='red', length_includes_head=True)\n\n# Add labels for N_s and N_a\nax.text(2, -0.5, r'$N_a = 4 \\times 4 = 16$ adsorption sites', ha='center')\nax.text(2, 4.5, r'$N_s = 5$ sorbent particles', color='blue', ha='center')\n\n# Hide ticks\nax.set_xticklabels([])\nax.set_yticklabels([])\n\n# Show plot\nplt.gca().set_aspect('equal', adjustable='box')\nplt.show()","visibility":"hide","key":"hscXs0zleR"},{"type":"output","id":"bkVdVzs7Cv8GBBQ4DLrs6","data":[],"visibility":"show","key":"oE47PvmToF"}],"data":{"tags":[]},"visibility":"show","key":"SBwd1jJdxg"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"The figure above shows the same sorbent system as before, but now with interactions between the sorbent particles represented by red arrows. In a mean-field model, these interactions are replaced by a constant mean-field interaction energy.","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"DJIRSK3G4N"}],"key":"rvukEoru8a"},{"type":"heading","depth":2,"position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"Grand Canonical Monte Carlo Simulations","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"gaMGUCNzNA"}],"identifier":"grand-canonical-monte-carlo-simulations","label":"Grand Canonical Monte Carlo Simulations","html_id":"grand-canonical-monte-carlo-simulations","implicit":true,"key":"bk9LI9uDlE"},{"type":"paragraph","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"In Lecture 14, we implemented a basic Metropolis algorithm for the canonical ensemble. In this lecture and the associated project, we will extend the Metropolis algorithm to the grand canonical ensemble to study adsorption on surfaces.","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"KhyH6QP0SU"}],"key":"IaZPpCkRja"},{"type":"heading","depth":3,"position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"Grand Canonical Ensemble","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"wCFKcPNLCl"}],"identifier":"grand-canonical-ensemble","label":"Grand Canonical Ensemble","html_id":"grand-canonical-ensemble","implicit":true,"key":"lyzntQypf1"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"In the grand canonical ensemble, the system is in contact with a reservoir of particles at constant chemical potential ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"wGXx93dqzQ"},{"type":"inlineMath","value":"\\mu","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span>","key":"tMbbGk4h0r"},{"type":"text","value":", volume ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"fPqB4onZaY"},{"type":"inlineMath","value":"V","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"rht9EJK7os"},{"type":"text","value":", and inverse temperature ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"NjqgnFMAM0"},{"type":"inlineMath","value":"\\beta","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span>","key":"BZDYgacs47"},{"type":"text","value":". The number of particles in the system is allowed to fluctuate, and the probability of finding the system in a state with ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"QQ5BNWa2vO"},{"type":"inlineMath","value":"N","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"KOuWH8yzlu"},{"type":"text","value":" particles is given by","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"IBuKQwVezY"}],"key":"DmENncngl1"},{"type":"math","value":"P(N) = \\frac{e^{-\\beta [E(N) - \\mu N]}}{Z}","position":{"start":{"line":182,"column":1},"end":{"line":184,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><msup><mi>e</mi><mrow><mo>−</mo><mi>β</mi><mo stretchy=\"false\">[</mo><mi>E</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>μ</mi><mi>N</mi><mo stretchy=\"false\">]</mo></mrow></msup><mi>Z</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">P(N) = \\frac{e^{-\\beta [E(N) - \\mu N]}}{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.251em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.565em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen mtight\">[</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">μ</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose mtight\">]</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"2","key":"tVnh4AOt6c"},{"type":"paragraph","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"asJdPHx2YW"},{"type":"inlineMath","value":"E(N)","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">E(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"ZHaA9pBlfa"},{"type":"text","value":" is the energy of the system with ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"ywQwpNEFcS"},{"type":"inlineMath","value":"N","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"YoxoFGH3yd"},{"type":"text","value":" particles, and ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"Rjug22Nppc"},{"type":"inlineMath","value":"Z","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span>","key":"YG2nvrE9jZ"},{"type":"text","value":" is the grand canonical partition function.","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"T4f94mikwn"}],"key":"Fgalc8lniD"},{"type":"heading","depth":3,"position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"Metropolis Algorithm for Grand Canonical Ensemble","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"oTfGXRM4is"}],"identifier":"metropolis-algorithm-for-grand-canonical-ensemble","label":"Metropolis Algorithm for Grand Canonical Ensemble","html_id":"metropolis-algorithm-for-grand-canonical-ensemble","implicit":true,"key":"fSPxuoH8NK"},{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"To simulate the grand canonical ensemble using the Metropolis algorithm, we need to modify the acceptance criterion to account for changes in the number of particles. The acceptance probability for adding a particle to the system is given by","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"LbDoOoGeaI"}],"key":"iqzRhkXKBt"},{"type":"math","value":"{\\rm acc}(N \\rightarrow N+1) = \\min\\left[1, \\frac{N_a - N}{N + 1} \\exp\\left[-\\beta (E(N+1) - E(N) - \\mu)\\right]\\right]","position":{"start":{"line":192,"column":1},"end":{"line":194,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">c</mi></mrow><mo stretchy=\"false\">(</mo><mi>N</mi><mo>→</mo><mi>N</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mi>min</mi><mo>⁡</mo><mrow><mo fence=\"true\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mfrac><mrow><msub><mi>N</mi><mi>a</mi></msub><mo>−</mo><mi>N</mi></mrow><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">[</mo><mo>−</mo><mi>β</mi><mo stretchy=\"false\">(</mo><mi>E</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>−</mo><mi>E</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">{\\rm acc}(N \\rightarrow N+1) = \\min\\left[1, \\frac{N_a - N}{N + 1} \\exp\\left[-\\beta (E(N+1) - E(N) - \\mu)\\right]\\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">acc</span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mop\">min</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">[</span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\">]</span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"3","key":"HOufjq5QtG"},{"type":"paragraph","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"wLxJrbHPkL"},{"type":"inlineMath","value":"N_a","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>a</mi></msub></mrow><annotation encoding=\"application/x-tex\">N_a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"xv4XSggrh9"},{"type":"text","value":" is the total number of adsorption sites on the surface. The acceptance probability for removing a particle from the system is given by","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"RuqsAG9ygj"}],"key":"wCogWnltaL"},{"type":"math","value":"{\\rm acc}(N \\rightarrow N-1) = \\min\\left[1, \\frac{N}{N_a - N + 1} \\exp\\left[-\\beta (E(N-1) - E(N) + \\mu)\\right]\\right]","position":{"start":{"line":198,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mi mathvariant=\"normal\">a</mi><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">c</mi></mrow><mo stretchy=\"false\">(</mo><mi>N</mi><mo>→</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mi>min</mi><mo>⁡</mo><mrow><mo fence=\"true\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mfrac><mi>N</mi><mrow><msub><mi>N</mi><mi>a</mi></msub><mo>−</mo><mi>N</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">[</mo><mo>−</mo><mi>β</mi><mo stretchy=\"false\">(</mo><mi>E</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>−</mo><mi>E</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>μ</mi><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">{\\rm acc}(N \\rightarrow N-1) = \\min\\left[1, \\frac{N}{N_a - N + 1} \\exp\\left[-\\beta (E(N-1) - E(N) + \\mu)\\right]\\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">acc</span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mop\">min</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">[</span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\">]</span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"4","key":"PTJnZIYToN"},{"type":"heading","depth":2,"position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"Steps for Implementing a Grand Canonical Monte Carlo Simulation","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"CF7g5tI265"}],"identifier":"steps-for-implementing-a-grand-canonical-monte-carlo-simulation","label":"Steps for Implementing a Grand Canonical Monte Carlo Simulation","html_id":"steps-for-implementing-a-grand-canonical-monte-carlo-simulation","implicit":true,"key":"cigJWYrWHI"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"To implement a grand canonical Monte Carlo simulation for adsorption on surfaces, we can follow these steps:","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"zZuuXdlkwY"}],"key":"VQBH5w7vIP"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":206,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"Initialize the system with a random distribution of sorbent particles on the surface.","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"l0BYoCbihe"}],"key":"QtLgmzfeKx"},{"type":"listItem","spread":true,"position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"children":[{"type":"text","value":"Choose a random move (addition or removal of a sorbent particle) and calculate the change in energy.","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"key":"hxYk7uhee4"}],"key":"u7s0PwzOcz"},{"type":"listItem","spread":true,"position":{"start":{"line":208,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"text","value":"Accept or reject the move based on the acceptance probability.","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"CqYxVQaVTM"}],"key":"mr9r3hoHtT"}],"key":"j4zdWrBCcf"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"By repeating these steps for a large number of iterations, we can sample the grand canonical ensemble and calculate the adsorption isotherm.","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"eYnYj36DTa"}],"key":"qDWhhgENWY"},{"type":"heading","depth":2,"position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"Example 1: Adsorption of Ideal Sorbent Particles on a Square Lattice","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"NKYHODFgSz"}],"identifier":"example-1-adsorption-of-ideal-sorbent-particles-on-a-square-lattice","label":"Example 1: Adsorption of Ideal Sorbent Particles on a Square Lattice","html_id":"example-1-adsorption-of-ideal-sorbent-particles-on-a-square-lattice","implicit":true,"key":"VvOTOOKH9e"},{"type":"paragraph","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"Let’s consider the adsorption of ideal sorbent particles on a ","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"uUaNd1i7Ji"},{"type":"inlineMath","value":"4 \\times 4","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4 \\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"VbDgxbfhPE"},{"type":"text","value":" square lattice. We will implement a grand canonical Monte Carlo simulation to study the adsorption isotherm of the system.","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"TvRj5Ez1Pc"}],"key":"RxlWSswcWO"},{"type":"heading","depth":3,"position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Energy Calculation","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"sUqjt1ndc0"}],"identifier":"energy-calculation","label":"Energy Calculation","html_id":"energy-calculation","implicit":true,"key":"clgTBOpdGW"},{"type":"paragraph","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"text","value":"The energy of the system is given by","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"AFX9RseLdr"}],"key":"mowdY2rk9G"},{"type":"math","value":"E(N) = N \\epsilon","position":{"start":{"line":220,"column":1},"end":{"line":222,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>E</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>N</mi><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">E(N) = N \\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\">ϵ</span></span></span></span></span>","enumerator":"5","key":"DXu69dtbSO"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"nidyyU8pki"},{"type":"inlineMath","value":"\\epsilon","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"BmHWTtY636"},{"type":"text","value":" is the interaction energy between the sorbent particles and the surface. Let’s define the energy function for the system.","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"VDJLhDaPYI"}],"key":"AVA4vv20rM"}],"key":"mU6xi4dqVQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def energy_ideal_sorbent(N, epsilon=-1.0):\n    \"\"\"Calculate the energy of the ideal sorbent system.\"\"\"\n    return N * epsilon","key":"daU4VrWJm0"},{"type":"output","id":"49yEoulYpo90PoYVg9CXt","data":[],"key":"XK0X2wc2mH"}],"key":"gsgCVsN9If"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"children":[{"type":"text","value":"Grand Canonical Monte Carlo Simulation","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"HiLVPV4hYm"}],"identifier":"grand-canonical-monte-carlo-simulation","label":"Grand Canonical Monte Carlo Simulation","html_id":"grand-canonical-monte-carlo-simulation","implicit":true,"key":"JmKHmD7uxn"},{"type":"paragraph","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"Now, let’s implement the grand canonical Monte Carlo simulation for the ideal sorbent system.","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"PK9CVZk6WT"}],"key":"zu2gjcSzyB"}],"key":"nqCEGvlXfZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\n\nnp.random.seed(42)\n\ndef grand_canonical_mc_ideal_sorbent(N_a, mu, beta, epsilon, n_steps=10000):\n    \"\"\"Perform grand canonical Monte Carlo simulation for ideal sorbent particles.\"\"\"\n    # Initialize the system\n    N = 0\n    coverage = []\n    \n    for _ in range(n_steps):\n        # Choose a random move\n        if np.random.rand() < 0.5:\n            # Attempt to add a particle\n            energy_diff = energy_ideal_sorbent(N + 1, epsilon) - energy_ideal_sorbent(N, epsilon)\n            # acc_prob = min(1, (N_a - N) / (N + 1) * np.exp(-beta * (epsilon - mu)))\n            acc_prob = min(1, (N_a - N) / (N + 1) * np.exp(-beta * (energy_diff - mu)))\n            if np.random.rand() < acc_prob:\n                N += 1\n        else:\n            # Attempt to remove a particle\n            energy_diff = energy_ideal_sorbent(N - 1, epsilon) - energy_ideal_sorbent(N, epsilon)\n            # acc_prob = min(1, N / (N_a - N + 1) * np.exp(-beta * (epsilon + mu)))\n            acc_prob = min(1, N / (N_a - N + 1) * np.exp(-beta * (energy_diff + mu)))\n            if np.random.rand() < acc_prob:\n                N -= 1\n        \n        # Calculate coverage\n        theta = N / N_a\n        coverage.append(theta)\n    \n    return coverage","key":"VHN9E1YIzF"},{"type":"output","id":"uxoqA_0yUkghTjWtibLsl","data":[],"key":"VW4nCa7TmE"}],"key":"OR1nAU5Ejs"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"text","value":"Simulation Results","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"cg1L2TOIaQ"}],"identifier":"simulation-results","label":"Simulation Results","html_id":"simulation-results","implicit":true,"key":"JK2B3M5bcB"},{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"Let’s run the grand canonical Monte Carlo simulation for the ideal sorbent system and plot the adsorption isotherm.","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"XrWfMBU3mi"}],"key":"zRC0uqaPN7"}],"key":"QwrfUqha8y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n# Define system parameters\nN_a = 16\nmus = np.linspace(-2, 0, 21)\nbeta = 10.0\nepsilon = -1.0\n\n# Perform grand canonical Monte Carlo simulation for different chemical potentials\ncoverages = [np.mean(grand_canonical_mc_ideal_sorbent(N_a, mu, beta, epsilon)) for mu in mus]\n\n# Calculate the analytical solution\nmus_analytical = np.linspace(-2, 0, 100)\ncoverages_analytical = [np.exp(beta * (mu - epsilon)) / (1 + np.exp(beta * (mu - epsilon))) for mu in mus_analytical]\n\n# Plot the adsorption isotherm\nplt.plot(mus, coverages, 'o-', label='Simulation')\nplt.plot(mus_analytical, coverages_analytical, '--', label='Analytical')\nplt.xlabel(r'Chemical potential $\\mu$')\nplt.ylabel(r'Coverage $\\theta$')\nplt.legend()\nplt.show()","key":"cHSmimLSx0"},{"type":"output","id":"jLVWQf7hGo2HCpysMFwHA","data":[],"key":"iieI689FVa"}],"key":"EqpD8poh9u"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"text","value":"The plot above shows the adsorption isotherm for the ideal sorbent system obtained from the grand canonical Monte Carlo simulation (solid line) and the analytical solution (dashed line). The coverage of the surface increases with the chemical potential, as expected because the sorbent particles are more likely to adsorb on the surface at higher chemical potentials.","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"QGl3CLOIVY"}],"key":"PVde7azxOv"},{"type":"heading","depth":2,"position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"Example 2: Adsorption of Sorbent Particles with Mean-Field Interactions","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"sS3w1r48SH"}],"identifier":"example-2-adsorption-of-sorbent-particles-with-mean-field-interactions","label":"Example 2: Adsorption of Sorbent Particles with Mean-Field Interactions","html_id":"example-2-adsorption-of-sorbent-particles-with-mean-field-interactions","implicit":true,"key":"TD2GNA1nxs"},{"type":"paragraph","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"text","value":"Next, let’s consider the adsorption of sorbent particles with mean-field interactions on a ","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"q79WhIJNHp"},{"type":"inlineMath","value":"4 \\times 4","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4 \\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"oR3jEKdKZV"},{"type":"text","value":" square lattice. We will implement a grand canonical Monte Carlo simulation to study the adsorption isotherm of the system.","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"F4yROrwRHF"}],"key":"zEHZfFv7Un"},{"type":"heading","depth":3,"position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"Energy Calculation","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"InUqfrD2Au"}],"identifier":"energy-calculation","label":"Energy Calculation","html_id":"energy-calculation-1","implicit":true,"key":"KE2DenIwhx"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"The energy of the system with mean-field interactions is given by","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"xVjl3794Rg"}],"key":"JTsXgxDJw2"},{"type":"math","value":"E(N) = N \\epsilon + N_a \\theta z \\epsilon_{\\rm int}","position":{"start":{"line":310,"column":1},"end":{"line":312,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>E</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>N</mi><mi>ϵ</mi><mo>+</mo><msub><mi>N</mi><mi>a</mi></msub><mi>θ</mi><mi>z</mi><msub><mi>ϵ</mi><mrow><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">n</mi><mi mathvariant=\"normal\">t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">E(N) = N \\epsilon + N_a \\theta z \\epsilon_{\\rm int}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3175em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">int</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"6","key":"HZ0ypKUM2A"},{"type":"paragraph","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"CGMa9Fd2z8"},{"type":"inlineMath","value":"z","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>","key":"jvP0VcBT3Z"},{"type":"text","value":" is the coordination number of the lattice, and ","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"J92iL9qETf"},{"type":"inlineMath","value":"\\epsilon_{\\rm int}","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mrow><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">n</mi><mi mathvariant=\"normal\">t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\epsilon_{\\rm int}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3175em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">int</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"cdRqozM2xD"},{"type":"text","value":" is the mean-field interaction energy between the sorbent particles. Let’s define the energy function for the system with mean-field interactions.","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"JD53apqIkP"}],"key":"wcJavg55eO"}],"key":"oG6cC9A3Pn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def energy_mean_field_sorbent(N, N_a, coverage, z=4, epsilon=-1.0, epsilon_int=0.1):\n    \"\"\"Calculate the energy of the system with mean-field interactions.\"\"\"\n    return N * epsilon + N_a * coverage * z * epsilon_int","key":"D7luxFJ9pE"},{"type":"output","id":"BxPk0RkbV6z5U1Z6qq1vO","data":[],"key":"rAFpqtYQGx"}],"key":"MiuHp1uUFW"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Derivation of ","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"Fzye6kyKYG"},{"type":"inlineMath","value":"N_a \\theta z","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>a</mi></msub><mi>θ</mi><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">N_a \\theta z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>","key":"TpChg44dyT"}],"key":"V1RSB7M4ye"},{"type":"paragraph","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"The term ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"ljVbdtEcYD"},{"type":"inlineMath","value":"N_a \\theta z","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>a</mi></msub><mi>θ</mi><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">N_a \\theta z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>","key":"L1aGh82VEV"},{"type":"text","value":" in the energy expression accounts for the mean-field interactions between the sorbent particles. The factor ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"feE916xW6s"},{"type":"inlineMath","value":"N_a","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>a</mi></msub></mrow><annotation encoding=\"application/x-tex\">N_a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"HcOZZLcqhi"},{"type":"text","value":" represents the total number of adsorption sites on the surface, ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"irCjmMK2eU"},{"type":"inlineMath","value":"\\theta","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span>","key":"lHc4g9MNQs"},{"type":"text","value":" is the coverage of the surface by the sorbent particles, and ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"eWd78GQ5dl"},{"type":"inlineMath","value":"z","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>","key":"nuomu4K4GM"},{"type":"text","value":" is the coordination number of the lattice. The product ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"WzfIuwlNE2"},{"type":"inlineMath","value":"N_a \\theta z","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>a</mi></msub><mi>θ</mi><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">N_a \\theta z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>","key":"wvn9KtbvR7"},{"type":"text","value":" gives the number of interactions between each sorbent particle and its ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"Q3a5CkEkTF"},{"type":"inlineMath","value":"z","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>","key":"valAjrA02O"},{"type":"text","value":" nearest neighbors on the lattice.","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"BsFdJsQfK4"}],"key":"CeHioi7cEA"}],"class":"dropdown","key":"DTUF0w7ZiO"},{"type":"heading","depth":3,"position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"children":[{"type":"text","value":"Grand Canonical Monte Carlo Simulation","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"LozmVs2TUg"}],"identifier":"grand-canonical-monte-carlo-simulation","label":"Grand Canonical Monte Carlo Simulation","html_id":"grand-canonical-monte-carlo-simulation-1","implicit":true,"key":"gBexNsyHn4"},{"type":"paragraph","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"children":[{"type":"text","value":"Now, let’s implement the grand canonical Monte Carlo simulation for the system with mean-field interactions.","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"lRmrefCJyg"}],"key":"NcAHupnhjS"}],"key":"ewM0h5QsH3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np.random.seed(42)\n\ndef grand_canonical_mc_mean_field_sorbent(N_a, mu, beta, epsilon, epsilon_int, n_steps=10000):\n    \"\"\"Perform grand canonical Monte Carlo simulation for sorbent particles with mean-field interactions.\"\"\"\n    # Initialize the system\n    N = 0\n    coverage = []\n    \n    for _ in range(n_steps):\n        # Current coverage\n        theta = N / N_a\n        \n        # Choose a random move\n        if np.random.rand() < 0.5:\n            # Attempt to add a particle\n            theta_after = (N + 1) / N_a\n            energy_diff = (energy_mean_field_sorbent(N + 1, N_a, theta_after, epsilon=epsilon, epsilon_int=epsilon_int) -\n                           energy_mean_field_sorbent(N, N_a, theta, epsilon=epsilon, epsilon_int=epsilon_int))\n            acc_prob = min(1, (N_a - N) / (N + 1) * np.exp(-beta * (energy_diff - mu)))\n            if np.random.rand() < acc_prob:\n                N += 1\n        else:\n            # Attempt to remove a particle\n            theta_after = (N - 1) / N_a\n            energy_diff = (energy_mean_field_sorbent(N - 1, N_a, theta_after, epsilon=epsilon, epsilon_int=epsilon_int) -\n                           energy_mean_field_sorbent(N, N_a, theta, epsilon=epsilon, epsilon_int=epsilon_int))\n            acc_prob = min(1, N / (N_a - N + 1) * np.exp(-beta * (energy_diff + mu)))\n            if N > 0 and np.random.rand() < acc_prob:\n                N -= 1\n        \n        # Update coverage\n        theta = N / N_a\n        coverage.append(theta)\n    \n    return coverage","key":"Bq5pEOm1yO"},{"type":"output","id":"StoE542GfFbktxUN3nf6X","data":[],"key":"mHvdk2or0X"}],"key":"DGJScGwXqs"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"Simulation Results","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"pLAj4RXoR3"}],"identifier":"simulation-results","label":"Simulation Results","html_id":"simulation-results-1","implicit":true,"key":"EKxI8LpqYk"},{"type":"paragraph","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"children":[{"type":"text","value":"Let’s run the grand canonical Monte Carlo simulation for the system with mean-field interactions and plot the adsorption isotherm.","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"key":"hdfpCn6D2J"}],"key":"wWLmuamj1g"}],"key":"Zmlh7p8XRs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define system parameters\nN_a = 16\nmus = np.linspace(-2, 1, 31)\nbeta = 10.0\nepsilon = -1.0\nepsilon_int = 0.1\n\n# Perform grand canonical Monte Carlo simulation for different chemical potentials\ncoverages_ideal_sorbent = [np.mean(grand_canonical_mc_ideal_sorbent(N_a, mu, beta, epsilon)) for mu in mus]\ncoverages_mean_field_sorbent = [np.mean(grand_canonical_mc_mean_field_sorbent(N_a, mu, beta, epsilon, epsilon_int)) for mu in mus]\n\n# Plot the adsorption isotherm\nplt.plot(mus, coverages_ideal_sorbent, 'o-', label='Ideal Sorbent')\nplt.plot(mus, coverages_mean_field_sorbent, 'o-', label='Mean-Field Sorbent')\nplt.axhline(y=0.5, color='gray', linestyle='--', label=r'$\\theta = 0.5$')\nplt.axvline(x=epsilon, color='gray', linestyle='--', label=r'$\\mu = \\epsilon$')\nplt.axvline(x=epsilon + 4 * epsilon_int, color='gray', linestyle='--', label=r'$\\mu = \\epsilon + 4 \\epsilon_{\\rm int}$')\nplt.xlabel(r'Chemical potential $\\mu$')\nplt.ylabel(r'Coverage $\\theta$')\nplt.legend()\nplt.show()","key":"JSt5F2DRr4"},{"type":"output","id":"kd6owGkvq0uIabjc9y4Nf","data":[],"key":"dHwu4v0crY"}],"key":"CM9P1I0Mf1"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"text","value":"The plot above shows the adsorption isotherm for the ideal sorbent system and the system with mean-field interactions obtained from the grand canonical Monte Carlo simulation. The dashed lines indicate the critical chemical potentials where the coverage of the surface is equal to 0.5.","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"cKmjlU5EKa"}],"key":"fUnqZcx46K"},{"type":"heading","depth":2,"position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"text","value":"Conclusion","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"J0XpJxi15i"}],"identifier":"conclusion","label":"Conclusion","html_id":"conclusion","implicit":true,"key":"iezMRhmvhp"},{"type":"paragraph","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"In this lecture, we introduced the concept of adsorption on surfaces and discussed the importance of Monte Carlo simulations in studying adsorption phenomena. We implemented grand canonical Monte Carlo simulations for ideal sorbent particles and sorbent particles with mean-field interactions on a square lattice. The simulations allowed us to calculate the adsorption isotherms of the systems and analyze the effects of chemical potential and interaction energies on the adsorption behavior.","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"UIwT6cQkUF"}],"key":"ON40zW7l19"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"TlLz6x8mV2"}],"key":"aFAeZ1VdJh"},{"type":"paragraph","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"children":[{"type":"text","value":"In the associated project, you will have the opportunity to explore more complex adsorption models and study the effects of different parameters on the adsorption isotherm. You will also learn how to analyze the simulation results and extract valuable information about the adsorption process.","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"Lc0HSa5nH9"}],"key":"LiMOQLT2Mx"}],"key":"rj8H33eMhO"}],"key":"e1gF2uqtDZ"}],"key":"IZDjIJP0Nw"},"references":{"cite":{"order":[],"data":{}}}}