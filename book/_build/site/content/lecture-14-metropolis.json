{"version":2,"kind":"Notebook","sha256":"80dcc2a6d0d2d398c9aad9bdb157f64976345d7785d3c813ea5b19f4d2d327d4","slug":"lecture-14-metropolis","location":"/lecture-14-metropolis.md","dependencies":[],"frontmatter":{"title":"Chapter 14: A Basic Monte Carlo Algorithm","kernelspec":{"name":"python3","display_name":"comp-prob-solv","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.16.4"}},"content_includes_title":false,"authors":[{"id":"Robert B. Wexler","name":"Robert B. Wexler"}],"github":"https://github.com/wexlergroup/comp-prob-solv","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/wexlergroup/comp-prob-solv/blob/main/book/lecture-14-metropolis.md","thumbnail":"/mississippi_river_de-47968057a34d7f63b2a68ca0c7fe8afa.png","exports":[{"format":"md","filename":"lecture-14-metropolis.md","url":"/lecture-14-metropoli-defe70edbf7f7abb6cfa8e98b4725376.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Learning Objectives","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"CRgTXd8rpJ"}],"identifier":"learning-objectives","label":"Learning Objectives","html_id":"learning-objectives","implicit":true,"key":"FbSglBw7Ed"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"By the end of this lecture, you should be able to","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"HEWLZpimV3"}],"key":"Tjp8p7Fhuj"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Derive the Metropolis algorithm for sampling from a probability distribution.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"e1BPap46Fm"}],"key":"zHtCIPYhI8"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Implement a basic Metropolis algorithm in Python.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"PN32aFJisJ"}],"key":"ASVGy2gS2V"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Apply the Metropolis algorithm to sample thermally accessible configurations of a simple system.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"jf3OzA1Mec"}],"key":"HkGIMqpJ4j"}],"key":"kcM4vi8Cae"},{"type":"thematicBreak","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"dYxA8aeZIQ"},{"type":"heading","depth":2,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"q6EfXF1VEs"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"r461GJopCY"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Evaluating statistical averages of the form","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"HAdyGZ7rqj"}],"key":"KpAK7RZfqc"},{"type":"math","value":"\\langle A \\rangle = \\frac{\\int d\\mathbf{r}^N \\, e^{-\\beta U(\\mathbf{r}^N)} A(\\mathbf{r}^N)}{\\int d\\mathbf{r}^N \\, e^{-\\beta U(\\mathbf{r}^N)}} = \\int d\\mathbf{r}^N \\, p(\\mathbf{r}^N) A(\\mathbf{r}^N),","position":{"start":{"line":30,"column":1},"end":{"line":32,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">⟨</mo><mi>A</mi><mo stretchy=\"false\">⟩</mo><mo>=</mo><mfrac><mrow><mo>∫</mo><mi>d</mi><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mtext> </mtext><msup><mi>e</mi><mrow><mo>−</mo><mi>β</mi><mi>U</mi><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mo stretchy=\"false\">)</mo></mrow></msup><mi>A</mi><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mo stretchy=\"false\">)</mo></mrow><mrow><mo>∫</mo><mi>d</mi><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mtext> </mtext><msup><mi>e</mi><mrow><mo>−</mo><mi>β</mi><mi>U</mi><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac><mo>=</mo><mo>∫</mo><mi>d</mi><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mtext> </mtext><mi>p</mi><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mo stretchy=\"false\">)</mo><mi>A</mi><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\langle A \\rangle = \\frac{\\int d\\mathbf{r}^N \\, e^{-\\beta U(\\mathbf{r}^N)} A(\\mathbf{r}^N)}{\\int d\\mathbf{r}^N \\, e^{-\\beta U(\\mathbf{r}^N)}} = \\int d\\mathbf{r}^N \\, p(\\mathbf{r}^N) A(\\mathbf{r}^N),</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">⟩</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.7295em;vertical-align:-1.027em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7025em;\"><span style=\"top:-2.2855em;\"><span class=\"pstrut\" style=\"height:3.0064em;\"></span><span class=\"mord\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7673em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8309em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7741em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.2364em;\"><span class=\"pstrut\" style=\"height:3.0064em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7025em;\"><span class=\"pstrut\" style=\"height:3.0064em;\"></span><span class=\"mord\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0064em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9191em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.027em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2222em;vertical-align:-0.8622em;\"></span><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"1","key":"HnWPT9KGJg"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"dCEicXYwOH"},{"type":"inlineMath","value":"\\mathbf{r}^N","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{r}^N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span></span></span></span>","key":"XON4epkmTH"},{"type":"text","value":" represents the coordinates of a system of ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"SD224THwiC"},{"type":"inlineMath","value":"N","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"wSH1VVG0zH"},{"type":"text","value":" particles, ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"XAhllSgRIS"},{"type":"inlineMath","value":"U(\\mathbf{r}^N)","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">U(\\mathbf{r}^N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"LgEMXFOyYw"},{"type":"text","value":" is the potential energy, ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"Dcz2dfBkos"},{"type":"inlineMath","value":"\\beta = 1/(k_B T)","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">(</mo><msub><mi>k</mi><mi>B</mi></msub><mi>T</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\beta = 1/(k_B T)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose\">)</span></span></span></span>","key":"ttLCT7TgXN"},{"type":"text","value":" is the inverse temperature, ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"jMCQrpfWaQ"},{"type":"inlineMath","value":"p(\\mathbf{r}^N) = e^{-\\beta U(\\mathbf{r}^N)}/Z","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>β</mi><mi>U</mi><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mo stretchy=\"false\">)</mo></mrow></msup><mi mathvariant=\"normal\">/</mi><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">p(\\mathbf{r}^N) = e^{-\\beta U(\\mathbf{r}^N)}/Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2564em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0064em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9191em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span>","key":"ZIsoHrPk30"},{"type":"text","value":" is the Boltzmann probability distribution, and ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"UibXNL8zKm"},{"type":"inlineMath","value":"Z","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span>","key":"rjRHcYORcV"},{"type":"text","value":" is the partition function, can be challenging due to the high dimensionality of the integral. The ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"cAwykeiCjO"},{"type":"strong","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Metropolis algorithm","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"fvP6cOfdtt"}],"key":"ya4vWUJiYq"},{"type":"text","value":" provides a way to sample configurations from ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"om2uXpdagN"},{"type":"inlineMath","value":"p(\\mathbf{r}^N)","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(\\mathbf{r}^N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"CIzoKSC1OI"},{"type":"text","value":", allowing us to approximate the average ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"Na3UV5LQl6"},{"type":"inlineMath","value":"\\langle A \\rangle","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">⟨</mo><mi>A</mi><mo stretchy=\"false\">⟩</mo></mrow><annotation encoding=\"application/x-tex\">\\langle A \\rangle</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">⟩</span></span></span></span>","key":"YW1E44JDEp"},{"type":"text","value":" by","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"RHwHFN7kwI"}],"key":"TbyuNOabAI"},{"type":"math","value":"\\langle A \\rangle \\approx \\frac{1}{M} \\sum_{i=1}^M A(\\mathbf{r}^N_i),","position":{"start":{"line":36,"column":1},"end":{"line":38,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">⟨</mo><mi>A</mi><mo stretchy=\"false\">⟩</mo><mo>≈</mo><mfrac><mn>1</mn><mi>M</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><mi>A</mi><mo stretchy=\"false\">(</mo><msubsup><mi mathvariant=\"bold\">r</mi><mi>i</mi><mi>N</mi></msubsup><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\langle A \\rangle \\approx \\frac{1}{M} \\sum_{i=1}^M A(\\mathbf{r}^N_i),</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">⟩</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"2","key":"HFi1RUz8GN"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"K5i8iPvL7Z"},{"type":"inlineMath","value":"M","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span>","key":"VGDvWQSvfo"},{"type":"text","value":" is the number of sampled configurations ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"yomkGGySCz"},{"type":"inlineMath","value":"\\mathbf{r}^N_i","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi mathvariant=\"bold\">r</mi><mi>i</mi><mi>N</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{r}^N_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1em;vertical-align:-0.2587em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hnMwBX4UJQ"},{"type":"text","value":".","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"qv02L0leQN"}],"key":"G247uTPPvc"},{"type":"thematicBreak","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"w4X4w1SHv4"},{"type":"heading","depth":2,"position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"The Metropolis Algorithm: “Measuring the Depth of the Mississippi”","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"H4oluPcPbr"}],"identifier":"the-metropolis-algorithm-measuring-the-depth-of-the-mississippi","label":"The Metropolis Algorithm: “Measuring the Depth of the Mississippi”","html_id":"the-metropolis-algorithm-measuring-the-depth-of-the-mississippi","implicit":true,"key":"VobbshtXef"},{"type":"image","url":"/mississippi_river_de-47968057a34d7f63b2a68ca0c7fe8afa.png","alt":"The Mississippi River","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"PjZFe3ob9d","urlSource":"mississippi_river_depth.png"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Traditional numerical integration methods, like quadrature, evaluate the integrand at predefined grid points, which can be inefficient in high-dimensional spaces or when the integrand is significant only in a small region of the domain. This is analogous to measuring the depth of the Mississippi River at regular intervals, regardless of whether those points are over water or land. The Metropolis algorithm improves upon this by focusing computational effort on regions where the integrand (or probability density) is large—much like concentrating measurements over the river itself rather than the surrounding land.","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"QXxZZm5KXh"}],"key":"dIZJi6h8EE"},{"type":"heading","depth":3,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Derivation of the Metropolis Algorithm","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"Y2jU54GWjL"}],"identifier":"derivation-of-the-metropolis-algorithm","label":"Derivation of the Metropolis Algorithm","html_id":"derivation-of-the-metropolis-algorithm","implicit":true,"key":"nWxpdiUwfs"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"To sample from the probability distribution ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"p5VHvnh3Iz"},{"type":"inlineMath","value":"p(\\mathbf{r}^N)","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(\\mathbf{r}^N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"mqIeai6BUq"},{"type":"text","value":", we construct a ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"WESKuzIXJq"},{"type":"strong","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Markov chain","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"C3syvacTBu"}],"key":"kbn1Liwo9d"},{"type":"text","value":" where the probability of transitioning from one configuration to another depends only on those two configurations.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"GnTrYpM9hy"}],"key":"yuoX1R7Gfg"},{"type":"heading","depth":4,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Detailed Balance Condition","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"BgHeAnsH3h"}],"identifier":"detailed-balance-condition","label":"Detailed Balance Condition","html_id":"detailed-balance-condition","implicit":true,"key":"PTyCEnIPAZ"},{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"For the Markov chain to converge to the desired distribution ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"YKaWhbporp"},{"type":"inlineMath","value":"p(\\mathbf{r}^N)","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">r</mi><mi>N</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(\\mathbf{r}^N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"dCQchDRwJK"},{"type":"text","value":", it must satisfy the ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"FD7X37Rgnb"},{"type":"strong","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"detailed balance condition","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"OgQm0F1WRU"}],"key":"s2WaqX4UAM"}],"key":"udQqEikqfs"},{"type":"math","value":"\\pi(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}}) \\, p(\\mathbf{r}_{\\text{old}}) = \\pi(\\mathbf{r}_{\\text{new}} \\rightarrow \\mathbf{r}_{\\text{old}}) \\, p(\\mathbf{r}_{\\text{new}}),","position":{"start":{"line":58,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>π</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>p</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>π</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>p</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\pi(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}}) \\, p(\\mathbf{r}_{\\text{old}}) = \\pi(\\mathbf{r}_{\\text{new}} \\rightarrow \\mathbf{r}_{\\text{old}}) \\, p(\\mathbf{r}_{\\text{new}}),</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"3","key":"vJnuzRf64d"},{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"h0bzHMsil8"},{"type":"inlineMath","value":"\\pi(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}})","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\pi(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"igtpNS7VIJ"},{"type":"text","value":" is the total transition probability from the old configuration to the new one. We can decompose ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"EpKRmENjKr"},{"type":"inlineMath","value":"\\pi","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"iPn12PPcij"},{"type":"text","value":" into two parts:","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"jSh1iRg7x4"}],"key":"h7tLfnJKU3"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":64,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"strong","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Proposal probability","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"IpaAw11Rvx"}],"key":"zRosHKA2hu"},{"type":"text","value":" ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"mElSLVT3hL"},{"type":"inlineMath","value":"\\alpha(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}})","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"TyXwmQBCsL"},{"type":"text","value":": The probability of proposing a move to ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"gkfosOEf9w"},{"type":"inlineMath","value":"\\mathbf{r}_{\\text{new}}","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{r}_{\\text{new}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"dKRM4bUwaN"},{"type":"text","value":".","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"hjlGzdY8lQ"}],"key":"kjbFvU8KIa"},{"type":"listItem","spread":true,"position":{"start":{"line":65,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"strong","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"Acceptance probability","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"o7B8y3W7fc"}],"key":"QZ0X8Ji1Xo"},{"type":"text","value":" ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"IkQhxAwSXV"},{"type":"inlineMath","value":"\\text{acc}(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}})","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>acc</mtext><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{acc}(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">acc</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"iCofFipNBF"},{"type":"text","value":": The probability of accepting the proposed move.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"lEiCcBkucO"}],"key":"YTS9gjq7lV"}],"key":"jCjDJUdRlR"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Thus,","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"ae2mv7WIIs"}],"key":"JzM44R9x81"},{"type":"math","value":"\\pi(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}}) = \\alpha(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}}) \\, \\text{acc}(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}}).","position":{"start":{"line":69,"column":1},"end":{"line":71,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>π</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>α</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo><mtext> </mtext><mtext>acc</mtext><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\pi(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}}) = \\alpha(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}}) \\, \\text{acc}(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}}).</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">acc</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4","key":"xWZFGnJeOL"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"If we choose a ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"z2H90nYqN8"},{"type":"strong","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"symmetric proposal distribution","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"ib9OGqzSic"}],"key":"c48XRyJVVD"},{"type":"text","value":" such that","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"OJw2h7GZ0A"}],"key":"u6FqwtaU8E"},{"type":"math","value":"\\alpha(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}}) = \\alpha(\\mathbf{r}_{\\text{new}} \\rightarrow \\mathbf{r}_{\\text{old}}),","position":{"start":{"line":75,"column":1},"end":{"line":77,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>α</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>α</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}}) = \\alpha(\\mathbf{r}_{\\text{new}} \\rightarrow \\mathbf{r}_{\\text{old}}),</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"5","key":"qTqEf0xUno"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"the detailed balance condition simplifies to","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"n5H0E7BAv2"}],"key":"W4XSUJqlUQ"},{"type":"math","value":"\\frac{\\text{acc}(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}})}{\\text{acc}(\\mathbf{r}_{\\text{new}} \\rightarrow \\mathbf{r}_{\\text{old}})} = \\frac{p(\\mathbf{r}_{\\text{new}})}{p(\\mathbf{r}_{\\text{old}})} = e^{-\\beta [U(\\mathbf{r}_{\\text{new}}) - U(\\mathbf{r}_{\\text{old}})]}.","position":{"start":{"line":81,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mtext>acc</mtext><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mtext>acc</mtext><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>β</mi><mo stretchy=\"false\">[</mo><mi>U</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>U</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow></msup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\frac{\\text{acc}(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}})}{\\text{acc}(\\mathbf{r}_{\\text{new}} \\rightarrow \\mathbf{r}_{\\text{old}})} = \\frac{p(\\mathbf{r}_{\\text{new}})}{p(\\mathbf{r}_{\\text{old}})} = e^{-\\beta [U(\\mathbf{r}_{\\text{new}}) - U(\\mathbf{r}_{\\text{old}})]}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">acc</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">acc</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.938em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen mtight\">[</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)]</span></span></span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"6","key":"FWRrPHR32F"},{"type":"heading","depth":4,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Acceptance Probability","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"nTEl24hoyN"}],"identifier":"acceptance-probability","label":"Acceptance Probability","html_id":"acceptance-probability","implicit":true,"key":"uYNtqUtxw2"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Metropolis ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"zNyMxubAOU"},{"type":"emphasis","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"et al.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"x5tfCLGogz"}],"key":"cJuQ3MFT1G"},{"type":"text","value":" proposed setting the acceptance probability to","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"fQKiB95qgg"}],"key":"cyCiyOwZ63"},{"type":"math","value":"\\text{acc}(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}}) = \\min\\left[1, e^{-\\beta [U(\\mathbf{r}_{\\text{new}}) - U(\\mathbf{r}_{\\text{old}})]}\\right].","position":{"start":{"line":89,"column":1},"end":{"line":91,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>acc</mtext><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo>→</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>min</mi><mo>⁡</mo><mrow><mo fence=\"true\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>β</mi><mo stretchy=\"false\">[</mo><mi>U</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>U</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow></msup><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\text{acc}(\\mathbf{r}_{\\text{old}} \\rightarrow \\mathbf{r}_{\\text{new}}) = \\min\\left[1, e^{-\\beta [U(\\mathbf{r}_{\\text{new}}) - U(\\mathbf{r}_{\\text{old}})]}\\right].</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">acc</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\"></span><span class=\"mop\">min</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">[</span></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen mtight\">[</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)]</span></span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"7","key":"oZ4s4swECY"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"This choice satisfies the detailed balance condition and ensures that the Markov chain will converge to the Boltzmann distribution.","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"K6gJadKoip"}],"key":"aW0qD7X4Ga"},{"type":"heading","depth":3,"position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"The Metropolis Algorithm Steps","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"O4okUiTddY"}],"identifier":"the-metropolis-algorithm-steps","label":"The Metropolis Algorithm Steps","html_id":"the-metropolis-algorithm-steps","implicit":true,"key":"j7kguPbl4U"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":97,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"strong","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"Initialization","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"SXovNtfAib"}],"key":"NbgbEmE25G"},{"type":"text","value":": Choose an initial configuration ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"egytuXZbpC"},{"type":"inlineMath","value":"\\mathbf{r}_{\\text{old}}","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{r}_{\\text{old}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"r3sQfj9DmA"},{"type":"text","value":".","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"ZnyYiicyqG"}],"key":"HszFntOHNH"}],"key":"KdgwnJeOPI"},{"type":"listItem","spread":true,"position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"strong","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"Proposal","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"j0C6sW8kcO"}],"key":"DpVL2Vniex"},{"type":"text","value":": Generate a new configuration ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"BShWarCD2L"},{"type":"inlineMath","value":"\\mathbf{r}_{\\text{new}}","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{r}_{\\text{new}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tPSkPn6dqH"},{"type":"text","value":" by making a small random change to ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"nTIFOYWT1G"},{"type":"inlineMath","value":"\\mathbf{r}_{\\text{old}}","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{r}_{\\text{old}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"y0YKqcIkyX"},{"type":"text","value":".","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"miPUJqTW2y"}],"key":"pmqBWVrlrA"}],"key":"j6ZIxhdgPw"},{"type":"listItem","spread":true,"position":{"start":{"line":99,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"strong","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"Compute Acceptance Probability","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"Y95HL0QBP0"}],"key":"yc5gqmjIKF"},{"type":"text","value":":","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"OqKZxe74Wx"}],"key":"DV32KauNXZ"},{"type":"math","value":"\\text{acc} = \\min\\left[1, e^{-\\beta [U(\\mathbf{r}_{\\text{new}}) - U(\\mathbf{r}_{\\text{old}})]}\\right].","position":{"start":{"line":101,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>acc</mtext><mo>=</mo><mi>min</mi><mo>⁡</mo><mrow><mo fence=\"true\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>β</mi><mo stretchy=\"false\">[</mo><mi>U</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>U</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow></msup><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\text{acc} = \\min\\left[1, e^{-\\beta [U(\\mathbf{r}_{\\text{new}}) - U(\\mathbf{r}_{\\text{old}})]}\\right].</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord text\"><span class=\"mord\">acc</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\"></span><span class=\"mop\">min</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">[</span></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span><span class=\"mopen mtight\">[</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)]</span></span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"8","key":"UR32g99E76"}],"key":"vSUUzbRGrR"},{"type":"listItem","spread":true,"position":{"start":{"line":105,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"strong","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"Accept or Reject Move","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"BbqJQXxVDP"}],"key":"lWbIi7wM0N"},{"type":"text","value":":","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"NnYSowKUWw"}],"key":"aB5nDKX3Rs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":106,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"Generate a random number ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"zBS4fHzpcq"},{"type":"inlineMath","value":"r \\in [0, 1]","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">r \\in [0, 1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"ve5zJi6lLm"},{"type":"text","value":".","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"up05U4YOR5"}],"key":"GOw1XNvBl9"},{"type":"listItem","spread":true,"position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"text","value":"If ","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"YnJKefwrXV"},{"type":"inlineMath","value":"r < \\text{acc}","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>&lt;</mo><mtext>acc</mtext></mrow><annotation encoding=\"application/x-tex\">r &lt; \\text{acc}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord text\"><span class=\"mord\">acc</span></span></span></span></span>","key":"uhLm6rbYuo"},{"type":"text","value":", accept the move (","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"rlTJtSWljw"},{"type":"inlineMath","value":"\\mathbf{r}_{\\text{new}}","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">r</mi><mtext>new</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{r}_{\\text{new}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">new</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"egfqBAplnT"},{"type":"text","value":" becomes the current configuration).","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"j621UpQohM"}],"key":"qlA3g9vI8h"},{"type":"listItem","spread":true,"position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"text","value":"Else, reject the move (retain ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"pWtIRcD5mk"},{"type":"inlineMath","value":"\\mathbf{r}_{\\text{old}}","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">r</mi><mtext>old</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{r}_{\\text{old}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">old</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"deVUI8CkKg"},{"type":"text","value":").","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"UkAhoSMTeS"}],"key":"M5btqypYwL"}],"key":"Hp7B0kX3NB"}],"key":"I9X2XYmxfo"},{"type":"listItem","spread":true,"position":{"start":{"line":109,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"strong","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"Iteration","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"ZQbzgBRGTc"}],"key":"fgpBbjOW7F"},{"type":"text","value":": Repeat steps 2–4 for a large number of steps to sample the distribution.","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"b25HWcBPYo"}],"key":"rjvrHy2EwF"}],"key":"yeVc4i9Ckr"}],"key":"LRQooNuknn"},{"type":"thematicBreak","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"ZlCu5B2aUF"},{"type":"heading","depth":2,"position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"Example: Sampling a Classical Morse Oscillator","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"ful8rZcAMd"}],"identifier":"example-sampling-a-classical-morse-oscillator","label":"Example: Sampling a Classical Morse Oscillator","html_id":"example-sampling-a-classical-morse-oscillator","implicit":true,"key":"hj1oHF6Jne"},{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"EHWzJVlSf1"},{"type":"strong","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"Morse potential","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"TXMVXt3bit"}],"key":"RHygQE7QqK"},{"type":"text","value":" models the potential energy of a diatomic molecule","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"rCcjavWbdi"}],"key":"A71QxBvf2h"},{"type":"math","value":"U(x) = D_e \\left[1 - e^{-\\alpha (x - x_e)}\\right]^2,","position":{"start":{"line":117,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>U</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>D</mi><mi>e</mi></msub><msup><mrow><mo fence=\"true\">[</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>α</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>e</mi></msub><mo stretchy=\"false\">)</mo></mrow></msup><mo fence=\"true\">]</mo></mrow><mn>2</mn></msup><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">U(x) = D_e \\left[1 - e^{-\\alpha (x - x_e)}\\right]^2,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.004em;vertical-align:-0.65em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">[</span></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.0037em;\">α</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">]</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.354em;\"><span style=\"top:-3.6029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"9","key":"Uk2Ho0VkMH"},{"type":"paragraph","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"PQ5JvRsKYn"},{"type":"inlineMath","value":"D_e","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mi>e</mi></msub></mrow><annotation encoding=\"application/x-tex\">D_e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"H4VHnhVKGg"},{"type":"text","value":" is the dissociation energy, ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"VTkX1OSEEw"},{"type":"inlineMath","value":"x_e","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>e</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ehwNI4ewSF"},{"type":"text","value":" is the equilibrium bond length, ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"Wz9LXSL2bJ"},{"type":"inlineMath","value":"\\alpha","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span>","key":"xDt1u6o4q0"},{"type":"text","value":" determines the width of the potential well, and ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"JQrqHa5QzB"},{"type":"inlineMath","value":"x","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"jCkc2bfAtz"},{"type":"text","value":" is the bond length.","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"W2fN9CYj5T"}],"key":"pUpn0SVM1m"},{"type":"heading","depth":3,"position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Visualization of the Morse Potential","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"I2DtHhbLZL"}],"identifier":"visualization-of-the-morse-potential","label":"Visualization of the Morse Potential","html_id":"visualization-of-the-morse-potential","implicit":true,"key":"XbRQA8781o"},{"type":"image","url":"/morse_potential-115703e967d94e5c0845b198a0c55e9e.png","alt":"Morse Oscillator","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"d9BDnwthf0","urlSource":"morse_potential.png"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"The potential well is asymmetric, leading to interesting thermal properties like thermal expansion.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"PvwozUirrv"}],"key":"HvjyBfQOic"},{"type":"thematicBreak","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"a410H4rjkS"},{"type":"heading","depth":2,"position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Implementing the Metropolis Algorithm in Python","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"IvevysLdVp"}],"identifier":"implementing-the-metropolis-algorithm-in-python","label":"Implementing the Metropolis Algorithm in Python","html_id":"implementing-the-metropolis-algorithm-in-python","implicit":true,"key":"nBHYG0UQcL"},{"type":"paragraph","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"We’ll implement the Metropolis algorithm to sample configurations from the Boltzmann distribution of the Morse oscillator.","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"BX88Gb4R9D"}],"key":"h9VkiIdWsp"}],"key":"ePYXebnQ2l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Import necessary libraries\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.constants import k, eV\n\n# Set random seed for reproducibility\nnp.random.seed(42)\n\n# Constants\nk_B = k / eV  # Boltzmann constant in eV/K\n\n# Morse potential parameters\nD_e = 1.0      # Dissociation energy in eV\nx_e = 1.0      # Equilibrium bond length\nalpha = 1.5    # Width parameter in 1/Å\nT = 300.0      # Temperature in K\nbeta = 1.0 / (k_B * T)\n\n# Define the Morse potential function\ndef morse_potential(x):\n    return D_e * (1 - np.exp(-alpha * (x - x_e)))**2\n\n# Define the Metropolis algorithm\ndef metropolis_sampling(x_init, n_steps, beta, delta):\n    x = x_init\n    samples = []\n    for _ in range(n_steps):\n        # Propose a new position\n        x_new = x + np.random.uniform(-delta, delta)\n        \n        # Compute the change in potential energy\n        delta_U = morse_potential(x_new) - morse_potential(x)\n        \n        # Acceptance probability\n        acceptance_prob = min(1.0, np.exp(-beta * delta_U))\n        \n        # Accept or reject the new position\n        if np.random.rand() < acceptance_prob:\n            x = x_new  # Accept the move\n        \n        samples.append(x)\n    return np.array(samples)","key":"HrDXWEnEWe"},{"type":"output","id":"DvzHUrS2gqO33cNqxPl3g","data":[],"key":"alrPkGvVKt"}],"key":"QLO3YXYeSs"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"Explanation of the Code","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"wiA7WgoU53"}],"identifier":"explanation-of-the-code","label":"Explanation of the Code","html_id":"explanation-of-the-code","implicit":true,"key":"Njbsuoa5xm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":182,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"strong","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"inlineCode","value":"morse_potential(x)","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"CNBpeOBisC"}],"key":"JHrhi0yJO8"},{"type":"text","value":": Computes the Morse potential at position ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"RAKcYGBVrz"},{"type":"inlineCode","value":"x","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"lb0ULIRTGi"},{"type":"text","value":".","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"oPFNhBK8yf"}],"key":"RXxA4M7tKZ"},{"type":"listItem","spread":true,"position":{"start":{"line":183,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"strong","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"inlineCode","value":"metropolis_sampling(x_init, n_steps, beta, delta)","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"LqfCT7zBsB"}],"key":"mnY5xfZvP0"},{"type":"text","value":":","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"ERK3rEnHPY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":184,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"inlineCode","value":"x_init","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"ludlWcJzEx"},{"type":"text","value":": Initial position.","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"r5ArHPm27b"}],"key":"QYn5q9Ebum"},{"type":"listItem","spread":true,"position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"inlineCode","value":"n_steps","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"XooEVF7L27"},{"type":"text","value":": Number of sampling steps.","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"MLWMfRuddr"}],"key":"VDnFpEJPNt"},{"type":"listItem","spread":true,"position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"inlineCode","value":"beta","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"xdQEH7VbnC"},{"type":"text","value":": Inverse temperature.","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"q27S6qb5Ld"}],"key":"A8oq208g4D"},{"type":"listItem","spread":true,"position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"inlineCode","value":"delta","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"mgWhbG5G60"},{"type":"text","value":": Maximum change allowed in a single move (controls step size).","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"alvYB4TkhF"}],"key":"LutmkzZIYj"},{"type":"listItem","spread":true,"position":{"start":{"line":188,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"The function returns an array of sampled positions.","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"lZLkPLQBAF"}],"key":"cfNfvZqWWO"}],"key":"Xftf5Ki0MP"}],"key":"hn7uxUIYC5"}],"key":"gc6IiKwr5x"},{"type":"thematicBreak","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"CKjbK5G3if"},{"type":"heading","depth":2,"position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"Running the Simulation","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"p9ILpuFIa0"}],"identifier":"running-the-simulation","label":"Running the Simulation","html_id":"running-the-simulation","implicit":true,"key":"WsF6eWdd1m"}],"key":"tpJgIbkfsX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Simulation parameters\nx_initial = x_e  # Start at equilibrium position\nn_equilibration = 10000\nn_sampling = 50000\ndelta = 0.1      # Maximum step size\n\n# Equilibration phase\nx_equilibrated = metropolis_sampling(x_initial, n_equilibration, beta, delta)\n\n# Sampling phase\nx_samples = metropolis_sampling(x_equilibrated[-1], n_sampling, beta, delta)","key":"caA7UyUUC6"},{"type":"output","id":"2KtxG0mEXXcqS0L1XtjR7","data":[],"key":"pQRmKNlF1b"}],"key":"EYBuU8PzjM"},{"type":"block","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"pJAqcGuo8r"}],"key":"lHaA9lAUnt"},{"type":"paragraph","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"SWrHH5hxzD"},{"type":"strong","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"text","value":"equilibration phase","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"hxsxB1tgcL"}],"key":"EeW9C14gx1"},{"type":"text","value":" allows the system to reach equilibrium before sampling. We discard these initial samples to ensure the system is in a stable configuration. The ","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"vF3kMux4RP"},{"type":"strong","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"text","value":"sampling phase","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"tDtsDAiXRE"}],"key":"QWtnqh8j1L"},{"type":"text","value":" collects samples for analysis.","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"l35sdvJDlq"}],"key":"nQUSLUsGd1"}],"key":"UiJdGP11Cc"},{"type":"thematicBreak","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"SbaFfCNstB"},{"type":"heading","depth":2,"position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"Analyzing the Results","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"gRo6Q1Qbvf"}],"identifier":"analyzing-the-results","label":"Analyzing the Results","html_id":"analyzing-the-results","implicit":true,"key":"FSnwEJkfGb"},{"type":"heading","depth":3,"position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Average Bond Length","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"Rp3Pm3ir80"}],"identifier":"average-bond-length","label":"Average Bond Length","html_id":"average-bond-length","implicit":true,"key":"y2jF30tAJD"}],"key":"ciWdCdPru8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Compute the average bond length\nx_avg = np.mean(x_samples)\nprint(f\"Average bond length at {T} K: {x_avg:.4f} Å\")","key":"mqjgWgZuav"},{"type":"output","id":"VVClmCdAB1UJ6sCeYb4fo","data":[],"key":"FtdlQscCFA"}],"key":"D5vjJl4JNH"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"Plotting the Results","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"bsLmY7rMTt"}],"identifier":"plotting-the-results","label":"Plotting the Results","html_id":"plotting-the-results","implicit":true,"key":"YdMYk3fvMs"},{"type":"aside","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"Bv3lGian8Z"}],"key":"pJ3rKN8j8B"},{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"“Time” here refers to the number of sampling steps.","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"BS6XXW8qzR"}],"key":"gTlnJcF7e6"}],"key":"XnBupcTLmJ"}],"key":"DvgLbViKEv"}],"key":"o9YhIkGnvK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Plotting the sampled positions over \"time\"\nplt.figure(figsize=(12, 5))\n\n# Left: \"Time series\" of bond lengths\nplt.subplot(1, 2, 1)\nplt.plot(x_samples, color='blue', alpha=0.5)\nplt.hlines([x_e, x_avg], xmin=0, xmax=n_sampling, colors=['red', 'green'], linestyles='dashed')\nplt.xlabel('Step')\nplt.ylabel('Bond Length (Å)')\nplt.title('Metropolis Sampling of Bond Length')\nplt.legend([r'$x_{\\text{sample}}$', r'$x_e$', r'$\\langle x \\rangle$'])\n\n# Right: Histogram and potential\nplt.subplot(1, 2, 2)\nx_range = np.linspace(x_e - 0.5, x_e + 1.0, 500)\nplt.plot(x_range, morse_potential(x_range), 'k-', label='Morse Potential')\nplt.hist(x_samples, bins=50, density=True, color='lightblue', alpha=0.7, label='Sampled Distribution')\nplt.xlabel('Bond Length (Å)')\nplt.ylabel('Probability Density')\nplt.title('Bond Length Distribution')\nplt.legend()\n\nplt.tight_layout()\nplt.show()","key":"VjeOxWuahl"},{"type":"output","id":"aeFyHFXbbGb_L1QXOXUdL","data":[],"key":"tZWfayUVHD"}],"key":"kNe40I8HCx"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Interpretation","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"iMTp9iftGh"}],"key":"bczUZ8iVSd"},{"type":"paragraph","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"wjzl8js0q6"},{"type":"strong","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"left plot","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"EoxRRkxUTS"}],"key":"pKYFq8jj2k"},{"type":"text","value":" shows how the bond length fluctuates over “time” during the simulation. The ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"maT0xmHQrn"},{"type":"strong","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"right plot","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"jZftjHMf0I"}],"key":"XDLeQ5ZleH"},{"type":"text","value":" overlays the Morse potential with the histogram of sampled bond lengths, showing that the sampling is concentrated near the minimum of the potential but is skewed towards longer bond lengths due to the asymmetry of the Morse potential.","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"s88B2q73w2"}],"key":"u34JCBTZF9"}],"class":"tip","key":"T7Zv7IlJC8"},{"type":"thematicBreak","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"yE1GNxAqV6"},{"type":"heading","depth":2,"position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"Thermal Expansion of the Morse Oscillator","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"Tep0CTP4jl"}],"identifier":"thermal-expansion-of-the-morse-oscillator","label":"Thermal Expansion of the Morse Oscillator","html_id":"thermal-expansion-of-the-morse-oscillator","implicit":true,"key":"eeoGBQlo8P"},{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"We now investigate how the average bond length changes with temperature, illustrating thermal expansion.","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"qBo1uOiF2q"}],"key":"DdsGLcCdGg"},{"type":"heading","depth":3,"position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"Simulation Over a Range of Temperatures","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"gFzuDWoLlu"}],"identifier":"simulation-over-a-range-of-temperatures","label":"Simulation Over a Range of Temperatures","html_id":"simulation-over-a-range-of-temperatures","implicit":true,"key":"t9INQQEw4Q"}],"key":"UIDPVnYZnc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Temperature range from 100 K to 1000 K\nT_values = np.linspace(100, 1000, 10)\nx_averages = []\n\nfor T in T_values:\n    beta = 1.0 / (k_B * T)\n    # Re-equilibrate at new temperature\n    _ = metropolis_sampling(x_e, n_equilibration, beta, delta)\n    # Sample\n    x_samples = metropolis_sampling(x_e, n_sampling, beta, delta)\n    # Compute average bond length\n    x_avg = np.mean(x_samples)\n    x_averages.append(x_avg)\n\n# Convert results to numpy arrays\nT_values = np.array(T_values)\nx_averages = np.array(x_averages)","key":"Tod5JkTbHO"},{"type":"output","id":"v_AzUZr741tUN7OivlEIE","data":[],"key":"MtlboIEPWi"}],"key":"QsFJWZjoUf"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"Plotting Thermal Expansion","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"pxGLFQABr2"}],"identifier":"plotting-thermal-expansion","label":"Plotting Thermal Expansion","html_id":"plotting-thermal-expansion","implicit":true,"key":"bhsKMKYgTO"}],"key":"ZZzNR5P8XC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Plot average bond length vs. temperature\nplt.figure(figsize=(8, 6))\nplt.plot(T_values, x_averages, 'o-', color='darkblue')\nplt.xlabel('Temperature (K)')\nplt.ylabel('Average Bond Length (Å)')\nplt.title('Thermal Expansion of the Morse Oscillator')\nplt.grid(True)\nplt.show()","key":"khab30U1Jb"},{"type":"output","id":"snK8DTRVsMANPEq5Qgtts","data":[],"key":"Wqn6FOw5G7"}],"key":"msSHaPDAH7"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Interpretation","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"NVk3t0Cc7I"}],"key":"r5WbdwMMlI"},{"type":"paragraph","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"children":[{"type":"text","value":"The plot shows that the average bond length increases with temperature. This is due to the anharmonicity of the Morse potential, which causes asymmetry in the potential energy well.","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"tiUZkpI08L"}],"key":"k2BKftR0oP"}],"class":"tip","key":"WSiLQnMVMj"},{"type":"thematicBreak","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"uB48A7b3bz"},{"type":"heading","depth":2,"position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"h08ke0t9N7"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"tLG6icRjmm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":314,"column":1},"end":{"line":318,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"BfD7OfWb4N"},{"type":"strong","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"text","value":"Metropolis algorithm","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"DgSmWzZnVN"}],"key":"HwgpABMTwB"},{"type":"text","value":" is a powerful tool for sampling from complex probability distributions, especially in high-dimensional spaces.","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"oTQrmlWYfm"}],"key":"RlSbnueB5A"},{"type":"listItem","spread":true,"position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"By satisfying the ","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"meuptVceJQ"},{"type":"strong","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"detailed balance condition","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"NAKwqs3XDV"}],"key":"FJnOsfdrK5"},{"type":"text","value":", the algorithm ensures convergence to the desired distribution.","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"rcjHcpnIjY"}],"key":"SgApBkyOrg"},{"type":"listItem","spread":true,"position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"children":[{"type":"text","value":"Applying the algorithm to the ","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"caFRYx8YoP"},{"type":"strong","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"children":[{"type":"text","value":"Morse oscillator","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"y6x1GZKusw"}],"key":"bEXv6HW77r"},{"type":"text","value":" demonstrates thermal expansion due to the anharmonicity of the potential.","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"X8avh8plL6"}],"key":"Q6gV9xOUhm"},{"type":"listItem","spread":true,"position":{"start":{"line":317,"column":1},"end":{"line":318,"column":1}},"children":[{"type":"text","value":"The Morse oscillator’s average bond length increases with temperature, illustrating how molecular vibrations contribute to macroscopic thermal expansion.","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"Vn1aooTgnw"}],"key":"SHzuo8HZOY"}],"key":"BeIdF0Dhnc"},{"type":"thematicBreak","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"svRswUgirT"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Additional Notes","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"KRslaTOks3"}],"key":"ctniVkdQa9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":323,"column":1},"end":{"line":325,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"children":[{"type":"strong","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"children":[{"type":"text","value":"Choice of Step Size (","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"IOOUf2jKkm"},{"type":"inlineCode","value":"delta","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"hSNHimYPrv"},{"type":"text","value":")","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"puJVmIcw22"}],"key":"AHPrJqKDTL"},{"type":"text","value":": The step size should be tuned to achieve an acceptance ratio (accepted moves over total proposed moves) of about 30%–50% for efficient sampling.","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"anJG4f1jTk"}],"key":"h2rp8HSBQR"},{"type":"listItem","spread":true,"position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"strong","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"Autocorrelation","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"kyzJUZbY6R"}],"key":"FMeSTEMnVw"},{"type":"text","value":": Successive samples may be correlated. To obtain independent samples, one can sample every few steps (thinning) or analyze the autocorrelation “time.”","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"cGAEcYfsmq"}],"key":"aBHCc62fwu"},{"type":"listItem","spread":true,"position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"children":[{"type":"strong","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"children":[{"type":"text","value":"Higher Dimensions","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"KPTH4uHNWY"}],"key":"BEnKNWAzn2"},{"type":"text","value":": The algorithm extends to systems with many particles by proposing moves in the multidimensional configuration space.","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"drPxIQsJHc"}],"key":"QnSHJKvEkz"}],"key":"ogO3sNg8OO"}],"class":"note","key":"bdjmzZTFcM"},{"type":"thematicBreak","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"dWMjYKFi49"},{"type":"heading","depth":2,"position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"h8AfHNuDBw"}],"identifier":"references","label":"References","html_id":"references","implicit":true,"key":"foYeX6DFx7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":332,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"text","value":"Metropolis, N., et al. “Equation of State Calculations by Fast Computing Machines.” ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"eOChTI6HEp"},{"type":"emphasis","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"text","value":"The Journal of Chemical Physics","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"etMeUAtyA3"}],"key":"Fj3oWvcnwD"},{"type":"text","value":" 21.6 (1953): 1087-1092. ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"qm5pu3t8hk"},{"type":"cite","url":"https://doi.org/10.1063/1.1699114","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"text","value":"Metropolis ","key":"hRkb58YbEq"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"G5kJVST5gq"}],"key":"VmiGDrvnvv"},{"type":"text","value":" (1953)","key":"CFW2Ng68NW"}],"kind":"narrative","label":"Metropolis_1953","identifier":"https://doi.org/10.1063/1.1699114","enumerator":"1","key":"Y1UVo1TUJL"}],"key":"L8O8KAdGSv"},{"type":"listItem","spread":true,"position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"text","value":"Frenkel, D., and B. Smit. ","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"DJcIlhi3AU"},{"type":"emphasis","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"text","value":"Understanding Molecular Simulation: From Algorithms to Applications","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"AbHVqbTKTP"}],"key":"aAWHWccuWp"},{"type":"text","value":". Academic Press, 2023. ","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"JkwEK1buGW"},{"type":"cite","url":"https://doi.org/10.1016/C2009-0-63921-0","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"text","value":"Elsevier (2023)","key":"Id4afMnnD1"}],"kind":"narrative","label":"2023","identifier":"https://doi.org/10.1016/C2009-0-63921-0","enumerator":"2","key":"xhJW2KzutE"}],"key":"XYjnyWDgcI"}],"key":"jyRMuJUUsg"}],"key":"kRppNftpIh"}],"key":"JSmW2ejRRW"},"references":{"cite":{"order":["Metropolis_1953","2023"],"data":{"2023":{"label":"2023","enumerator":"2","doi":"10.1016/c2009-0-63921-0","html":"(2023). Elsevier. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/c2009-0-63921-0\">10.1016/c2009-0-63921-0</a>","url":"https://doi.org/10.1016/c2009-0-63921-0"},"Metropolis_1953":{"label":"Metropolis_1953","enumerator":"1","doi":"10.1063/1.1699114","html":"Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., & Teller, E. (1953). Equation of State Calculations by Fast Computing Machines. <i>The Journal of Chemical Physics</i>, <i>21</i>(6), 1087–1092. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1063/1.1699114\">10.1063/1.1699114</a>","url":"https://doi.org/10.1063/1.1699114"}}}}}