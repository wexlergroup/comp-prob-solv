{"version":2,"kind":"Notebook","sha256":"b2c8306e142c610951228e94f029c7be9efd1be188306d4b08db52f62675cd9e","slug":"lecture-24-radial-dist","location":"/lecture-24-radial-dist.md","dependencies":[],"frontmatter":{"title":"Chapter 23: Radial Distribution Function","kernelspec":{"name":"python3","display_name":"comp-prob-solv","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.16.4"}},"content_includes_title":false,"authors":[{"id":"Robert B. Wexler","name":"Robert B. Wexler"}],"github":"https://github.com/wexlergroup/comp-prob-solv","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/wexlergroup/comp-prob-solv/blob/main/book/lecture-24-radial-dist.md","thumbnail":"/lj-1466806cb7408041f45d484330a63099.png","exports":[{"format":"md","filename":"lecture-24-radial-dist.md","url":"/lecture-24-radial-di-68d9b97b7ad24fb2238c9d623870441b.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Learning Objectives","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ntk3AzPXuI"}],"identifier":"learning-objectives","label":"Learning Objectives","html_id":"learning-objectives","implicit":true,"key":"Yzj7JA4FgU"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"By the end of this lecture, you will be able to:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"TP0UD8ZYal"}],"key":"W3lk2ra6qu"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Define the radial distribution function.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"jf7QFKX1GF"}],"key":"NvAr0aBzqZ"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Compute the radial distribution function for a given configuration of particles.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Q9Lqg7EgYH"}],"key":"GXOOxM7tXo"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Understand the physical significance of the radial distribution function.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ThxIQ2ceAY"}],"key":"lpoQCBgtuU"}],"key":"JVebaiFOJJ"},{"type":"heading","depth":2,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Radial Distribution Function","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"TATGuipU0P"}],"identifier":"radial-distribution-function","label":"Radial Distribution Function","html_id":"radial-distribution-function","implicit":true,"key":"wGOvnylBOE"}],"key":"NHBAzTY9DW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\n# Parameters\ncentral_particle = (0, 0)\nnum_particles = 100\nbox_size = 10\nr = 3.0  # Shell radius\ndr = 0.5  # Shell thickness\n\n# Generate random particle positions\nnp.random.seed(42)  # For reproducibility\nparticle_positions = np.random.uniform(-box_size/2, box_size/2, size=(num_particles, 2))\n\n# Plot setup\nfig, ax = plt.subplots(figsize=(8, 8))\nax.set_xlim(-box_size/2, box_size/2)\nax.set_ylim(-box_size/2, box_size/2)\nax.set_aspect('equal', adjustable='datalim')\n\n# Draw central particle\nax.plot(*central_particle, 'o', color='red', label='Central Particle')\n\n# Draw surrounding particles\nfor pos in particle_positions:\n    ax.plot(*pos, 'o', color='blue', markersize=5, alpha=0.7)\n\n# Draw the shell\ncircle_inner = plt.Circle(central_particle, r, color='green', fill=False, linestyle='--', label=f'$r = {r}$')\ncircle_outer = plt.Circle(central_particle, r + dr, color='orange', fill=False, linestyle='--', label=f'$r + \\Delta r = {r + dr}$')\nax.add_artist(circle_inner)\nax.add_artist(circle_outer)\n\n# Annotate particles within the shell\nfor pos in particle_positions:\n    distance = np.linalg.norm(np.array(pos) - np.array(central_particle))\n    if r <= distance < r + dr:\n        ax.plot(*pos, 'o', color='purple', markersize=7)\n\n# Add labels and legend\nax.set_title('Radial Distribution Function Demonstration')\nax.set_xlabel('$x$')\nax.set_ylabel('$y$')\nax.legend()\n\n# Show plot\nplt.show()","visibility":"hide","key":"K0cQryvcCO"},{"type":"output","id":"PCSQ2bzwJ3gX3ImojKNGG","data":[],"visibility":"show","key":"jMiFpGx1m9"}],"data":{"tags":[]},"visibility":"show","key":"M7t1FQPvjd"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"The radial distribution function, denoted by ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"mceutfy04A"},{"type":"inlineMath","value":"g(r)","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"RaVxcgDhqL"},{"type":"text","value":", is a measure of the “structure” of a fluid or solid. It quantifies the average number of particles at a distance ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"P5fHM7rCkv"},{"type":"inlineMath","value":"r","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"kBbRHPSPHW"},{"type":"text","value":" from a central particle relative to the ideal gas case. The radial distribution function is defined as","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"EQUWKkkMW6"}],"key":"KMMcL6qRlX"},{"type":"math","value":"g(r) = \\frac{\\langle N(r) \\rangle}{4 \\pi r^2 \\Delta r \\rho}","position":{"start":{"line":79,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mo stretchy=\"false\">⟨</mo><mi>N</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">⟩</mo></mrow><mrow><mn>4</mn><mi>π</mi><msup><mi>r</mi><mn>2</mn></msup><mi mathvariant=\"normal\">Δ</mi><mi>r</mi><mi>ρ</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">g(r) = \\frac{\\langle N(r) \\rangle}{4 \\pi r^2 \\Delta r \\rho}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3074em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">ρ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)⟩</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"WYvRfOkpCn"},{"type":"paragraph","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"QZHkXFTooC"},{"type":"inlineMath","value":"\\langle N(r) \\rangle","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">⟨</mo><mi>N</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">⟩</mo></mrow><annotation encoding=\"application/x-tex\">\\langle N(r) \\rangle</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)⟩</span></span></span></span>","key":"EV0yPv7YhU"},{"type":"text","value":" is the average number of particles in a shell of radius ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"dnT0n9o1wS"},{"type":"inlineMath","value":"r","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"JWZfQrgV9h"},{"type":"text","value":" and thickness ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"lkKCKuj6Z7"},{"type":"inlineMath","value":"\\Delta r","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"NGSg9rc5dw"},{"type":"text","value":" around a central particle, ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"F0OLu3Rx8f"},{"type":"inlineMath","value":"\\rho","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding=\"application/x-tex\">\\rho</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ρ</span></span></span></span>","key":"Xm6zPyFVUW"},{"type":"text","value":" is the number density of particles, and ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"REogMnq0ZJ"},{"type":"inlineMath","value":"r","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"N9TeFZrWrS"},{"type":"text","value":" is the distance from the central particle. The radial distribution function provides information about the local structure of a system, such as the presence of short-range order, long-range order, or disorder.","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"zLQvEj2NeV"}],"key":"T63rlItm4q"},{"type":"heading","depth":2,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Computing the Radial Distribution Function","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"I55isoihrz"}],"identifier":"computing-the-radial-distribution-function","label":"Computing the Radial Distribution Function","html_id":"computing-the-radial-distribution-function","implicit":true,"key":"M86HS2vEVO"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"To compute the radial distribution function for a given configuration of particles, we need to follow these steps:","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"h3ZYs1jQgH"}],"key":"wUMttQgNK6"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":89,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"Compute the distance between all pairs of particles in the system.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"iyWLzHT2V5"}],"key":"syylHlawef"},{"type":"listItem","spread":true,"position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"Bin the distances into radial bins.","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"zhAbnzhs7H"}],"key":"hRUunbCu2r"},{"type":"listItem","spread":true,"position":{"start":{"line":91,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"Compute the radial distribution function using the formula given above.","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"YYX9gH54Bk"}],"key":"ehYkLoJWOu"}],"key":"mdGmIyQqWH"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Let’s consider an example to illustrate how to compute the radial distribution function for a simple system of particles.","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"m2JVmHeKYH"}],"key":"Sa6ZnHleX3"},{"type":"heading","depth":2,"position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"Example: Lennard-Jones Fluid","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"TKjECgQ3wS"}],"identifier":"example-lennard-jones-fluid","label":"Example: Lennard-Jones Fluid","html_id":"example-lennard-jones-fluid","implicit":true,"key":"gnZAewMpZJ"},{"type":"image","url":"/lj-1466806cb7408041f45d484330a63099.png","alt":"Lennard-Jones Fluid","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"mdDqmcjMuR","urlSource":"lj.png"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"Consider a three-dimensional Lennard-Jones fluid (","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"hynfN4w4ft"},{"type":"inlineMath","value":"\\epsilon = 1","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"uiXH9knb0N"},{"type":"text","value":", ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"VUgpop0ZBk"},{"type":"inlineMath","value":"\\sigma = 1","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\sigma = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"GLJiaaD13p"},{"type":"text","value":", ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"lLXpnxyTY5"},{"type":"inlineMath","value":"r_c = 2.5","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mi>c</mi></msub><mo>=</mo><mn>2.5</mn></mrow><annotation encoding=\"application/x-tex\">r_c = 2.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.5</span></span></span></span>","key":"vU7v7ov0Ui"},{"type":"text","value":") with periodic boundary conditions and ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"umEmx8hIdx"},{"type":"inlineMath","value":"N = 1500","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><mn>1500</mn></mrow><annotation encoding=\"application/x-tex\">N = 1500</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1500</span></span></span></span>","key":"jtMy0aqHU8"},{"type":"text","value":" particles in a cubic box of side length ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"HRCXO4iYmB"},{"type":"inlineMath","value":"L = 20","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding=\"application/x-tex\">L = 20</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">20</span></span></span></span>","key":"w6BVSmKbwd"},{"type":"text","value":". The final configuration of the particles, after a molecular dynamics simulation at a temperature of ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"y6HWVW0IPB"},{"type":"inlineMath","value":"T = 0.5","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">T = 0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"Yu1lQU8Lqu"},{"type":"text","value":", is given in the file ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"jwoOvrlJhu"},{"type":"link","url":"https://wustl.instructure.com/courses/141498/files/8808015/download?download_frd=1","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"inlineCode","value":"lj.xyz","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"VET1c6EhxP"}],"urlSource":"https://wustl.instructure.com/courses/141498/files/8808015/download?download_frd=1","key":"OSAYUArRs6"},{"type":"text","value":". We want to compute the radial distribution function for this configuration of particles.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"jU2SA9IOEy"}],"key":"uk4XZk2qM1"},{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Let’s start by loading the configuration of particles from the file ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"GAMKduOP4j"},{"type":"inlineCode","value":"lj.xyz","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"AIW1nM9wwq"},{"type":"text","value":".","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"OAkFx84VzT"}],"key":"UrrnmNFgBr"}],"key":"LOGHsyY03P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load the configuration of particles from the file lj.xyz\nimport numpy as np\n\ndef read_xyz(filename):\n    with open(filename, 'r') as f:\n        lines = f.readlines()\n        n_atoms = int(lines[0])\n        data = np.zeros((n_atoms, 3))\n        for i in range(2, n_atoms + 2):\n            # Skip the first and second columns (id and species) and extract the x, y, z coordinates\n            data[i - 2] = np.array([float(x) for x in lines[i].split()[2:5]])\n    return data\n\n# Load the configuration of particles from the file lj.xyz\nfilename = 'lj.xyz'\npositions = read_xyz(filename)\nn_atoms = len(positions)\nprint(f'Number of particles: {n_atoms}')","key":"oO7saVIarQ"},{"type":"output","id":"svgvmP-GPH3U1Z46HCtQt","data":[],"key":"VVUYHuUbV6"}],"key":"k4jE1UwEFl"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"Now that we have loaded the configuration of particles, we can compute the distance between all pairs of particles in the system.","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"eUDffLQIbl"}],"key":"kc9fTJjs4n"}],"key":"Z1o2rsU5VN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Compute the distance between all pairs of particles in the system\ndef compute_distance(positions, box_length):\n    n_atoms = len(positions)\n    distances = []\n    for i in range(n_atoms):\n        for j in range(n_atoms):\n            if i >= j:\n                continue\n            dr = positions[i] - positions[j]\n            dr = dr - box_length * np.round(dr / box_length)\n            distance = np.linalg.norm(dr)\n            distances.append(distance)\n    return distances\n\n# Compute the distance between all pairs of particles in the system\nbox_length = 20\ndistances = compute_distance(positions, box_length)\nprint(f'Number of distances: {len(distances)}')\n\n# Compute the statistics of the distances\nprint(f'Minimum distance: {min(distances)}')\nprint(f'Maximum distance: {max(distances)}')\nprint(f'Mean distance: {np.mean(distances)}')\nprint(f'Standard deviation of distance: {np.std(distances)}')","key":"YSqDKPGqxC"},{"type":"output","id":"wSVyqwiOg9UsGVUDJ4kkN","data":[],"key":"D0Vr85FpTl"}],"key":"XMxNEug91S"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"Next, we need to bin the distances into radial bins. We will use a bin width of ","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"IWnR2MlESQ"},{"type":"text","value":"0.2","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"OQ1yqJk5qk"},{"type":"text","value":" and a maximum distance of ","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"k3MH7AQwlD"},{"type":"text","value":"10","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"tFWVtbJkb3"},{"type":"text","value":" for this example.","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"jd3na6ACXm"}],"key":"Wy6VQ5i7a0"}],"key":"CT5rXF9Q59"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Bin the distances into radial bins\ndef bin_distances(distances, bin_width, max_distance):\n    bins = np.arange(bin_width, max_distance + bin_width * 2, bin_width)\n    hist, _ = np.histogram(distances, bins=bins)\n    return hist\n\n# Bin the distances into radial bins\nbin_width = 0.01\nmax_distance = 3.5\nhist = bin_distances(distances, bin_width, max_distance)\nprint(f'Number of bins: {len(hist)}')","key":"Tt8LP61f1n"},{"type":"output","id":"p2EzEW-PEikNOXh6GGEo5","data":[],"key":"gSZ78csBrl"}],"key":"qBCRqhkHKr"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"Finally, we can compute the radial distribution function using the formula given above.","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"b8uphAFYs1"}],"key":"HgLR8peEfI"}],"key":"MEHOy7j7xu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def radial_distribution_function(hist, n_atoms, box_length, bin_width):\n    rho = n_atoms / box_length**3\n    r = (np.arange(1, len(hist) + 1) - 0.5) * bin_width\n    shell_volumes = 4 * np.pi * r**2 * bin_width\n    g = hist / (rho * n_atoms * shell_volumes)\n    return r, g\n\n# Compute the radial distribution function\nr, g = radial_distribution_function(hist, n_atoms, box_length, bin_width)","key":"GzuwWPwenD"},{"type":"output","id":"-ESjA056OuBg00OxZQq3L","data":[],"key":"wQmlr6QVuG"}],"key":"FkRCugLN9p"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"Now that we have computed the radial distribution function, we can plot it to visualize the structure of the fluid.","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"Ozp1RAitiu"}],"key":"eERW2TDIW0"}],"key":"eTubybfq6J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n# Plot the radial distribution function\nplt.plot(r, g)\nplt.xlabel('r')\nplt.ylabel('g(r)')\nplt.title('Radial Distribution Function')\n\n# Annotate the first peak\nfirst_peak_label = 'First Nearest Neighbor Peak'\nplt.annotate(\n    first_peak_label,\n    xy=(1.2, 3),\n    xytext=(1.5, 4),\n    arrowprops=dict(facecolor='black', shrink=0.05))\n\n# Annotate the second peak\nsecond_peak_label = 'Second Nearest Neighbor Peak'\nplt.annotate(\n    second_peak_label,\n    xy=(2.2, 1.5),\n    xytext=(2.5, 2),\n    arrowprops=dict(facecolor='black', shrink=0.05))\n\n# Annotate the third peak\nthird_peak_label = 'Third Nearest Neighbor Peak'\nplt.annotate(\n    third_peak_label,\n    xy=(3.2, 1),\n    xytext=(3.5, 1.5),\n    arrowprops=dict(facecolor='black', shrink=0.05))\n\n# Horizontal line at g(r) = 1\nplt.axhline(y=1, color='r', linestyle='--')\nplt.text(0, 1.1, 'Ideal Gas', color='red')\n\nplt.show()","visibility":"hide","key":"ibY3EcVGS6"},{"type":"output","id":"Dj9ChJvBTBlVKBnPgo891","data":[],"visibility":"show","key":"AvxEZIyKvO"}],"data":{"tags":[]},"visibility":"show","key":"ulcFwwW1GB"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"text","value":"Interpretation of the Radial Distribution Function","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"FKr5HTRUgR"}],"identifier":"interpretation-of-the-radial-distribution-function","label":"Interpretation of the Radial Distribution Function","html_id":"interpretation-of-the-radial-distribution-function","implicit":true,"key":"IXvvOdvg1i"},{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"The radial distribution function provides information about the local structure of a system. Here are some key points to keep in mind when interpreting the radial distribution function:","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"Z571stipJs"}],"key":"ZQie0RUn1g"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":230,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"inlineMath","value":"g(r) = 1","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">g(r) = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"NixjO1nnPU"},{"type":"text","value":" for an ideal gas, indicating no correlation between particles at different distances.","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"XCbsDocIsa"}],"key":"GQQnflDiRF"},{"type":"listItem","spread":true,"position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"inlineMath","value":"g(r) > 1","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">g(r) &gt; 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"Bh92vSnBJ0"},{"type":"text","value":" for attractive interactions, indicating clustering of particles at certain distances.","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"RF8h4t4OGU"}],"key":"oIQEnWG8oG"},{"type":"listItem","spread":true,"position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"children":[{"type":"inlineMath","value":"g(r) < 1","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">g(r) &lt; 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"BLQo07ZTbB"},{"type":"text","value":" for repulsive interactions, indicating exclusion of particles at certain distances.","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"TfiEQAkFVP"}],"key":"YZJ1wI2It4"},{"type":"listItem","spread":true,"position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"text","value":"Peaks in ","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"Vk1KxRm5q3"},{"type":"inlineMath","value":"g(r)","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"HotD3AuTeA"},{"type":"text","value":" correspond to the average number of particles at specific distances from a central particle.","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"imsM8KWUxy"}],"key":"CEto353inx"},{"type":"listItem","spread":true,"position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"The first peak in ","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"SD5EHKg54B"},{"type":"inlineMath","value":"g(r)","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"fVbrJpMVI5"},{"type":"text","value":" corresponds to the first nearest neighbor distance, the second peak to the second nearest neighbor distance, and so on.","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"Pa7IaA4daS"}],"key":"NlLpXITidb"},{"type":"listItem","spread":true,"position":{"start":{"line":235,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"The height and width of the peaks in ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"BjWz4LBFG3"},{"type":"inlineMath","value":"g(r)","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"dILOCEUrs2"},{"type":"text","value":" provide information about the strength and range of interactions between particles. Higher, narrower peaks indicate strong, short-range interactions, while broader peaks indicate weaker, longer-range interactions.","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"OrhDF7GaNW"}],"key":"qDgzpzeJRy"}],"key":"fQm2KIJrCF"},{"type":"heading","depth":2,"position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"EeMEaC3jB2"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"EnpiOJlo6g"},{"type":"paragraph","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"children":[{"type":"text","value":"In this lecture, we introduced the radial distribution function as a measure of the local structure of a fluid or solid. We discussed how to compute the radial distribution function for a given configuration of particles and interpret the results. The radial distribution function provides valuable insights into the interactions between particles in a system and will helps us understand the structure and properties of bead-spring polymers in the next lecture and project.","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"pPI2PCULv6"}],"key":"ZnpAqZRkfT"}],"key":"RcdgRJbW9x"}],"key":"FtL2AZlxTR"},"references":{"cite":{"order":[],"data":{}}}}