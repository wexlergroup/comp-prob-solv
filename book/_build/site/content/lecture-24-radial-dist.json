{"version":2,"kind":"Notebook","sha256":"b2c8306e142c610951228e94f029c7be9efd1be188306d4b08db52f62675cd9e","slug":"lecture-24-radial-dist","location":"/lecture-24-radial-dist.md","dependencies":[],"frontmatter":{"title":"Chapter 23: Radial Distribution Function","kernelspec":{"name":"python3","display_name":"comp-prob-solv","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.16.4"}},"content_includes_title":false,"authors":[{"id":"Robert B. Wexler","name":"Robert B. Wexler"}],"github":"https://github.com/wexlergroup/comp-prob-solv","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/wexlergroup/comp-prob-solv/blob/main/book/lecture-24-radial-dist.md","thumbnail":"/lj-1466806cb7408041f45d484330a63099.png","exports":[{"format":"md","filename":"lecture-24-radial-dist.md","url":"/lecture-24-radial-di-68d9b97b7ad24fb2238c9d623870441b.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Learning Objectives","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"AFNFp53Y3l"}],"identifier":"learning-objectives","label":"Learning Objectives","html_id":"learning-objectives","implicit":true,"key":"QG8FE4kS5j"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"By the end of this lecture, you will be able to:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"amlE5W42fv"}],"key":"BgIGwA9NfU"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Define the radial distribution function.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ivEny57OML"}],"key":"Nd9STpv08u"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Compute the radial distribution function for a given configuration of particles.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"zV90YeIbmm"}],"key":"RkmJRL1rwj"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Understand the physical significance of the radial distribution function.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"eKlJv76Htf"}],"key":"PJpx53YKd2"}],"key":"OFgWdm7eS7"},{"type":"heading","depth":2,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Radial Distribution Function","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"VFPQWZo0UC"}],"identifier":"radial-distribution-function","label":"Radial Distribution Function","html_id":"radial-distribution-function","implicit":true,"key":"hSAqOqFiy0"}],"key":"eqVO2L5gqk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\n# Parameters\ncentral_particle = (0, 0)\nnum_particles = 100\nbox_size = 10\nr = 3.0  # Shell radius\ndr = 0.5  # Shell thickness\n\n# Generate random particle positions\nnp.random.seed(42)  # For reproducibility\nparticle_positions = np.random.uniform(-box_size/2, box_size/2, size=(num_particles, 2))\n\n# Plot setup\nfig, ax = plt.subplots(figsize=(8, 8))\nax.set_xlim(-box_size/2, box_size/2)\nax.set_ylim(-box_size/2, box_size/2)\nax.set_aspect('equal', adjustable='datalim')\n\n# Draw central particle\nax.plot(*central_particle, 'o', color='red', label='Central Particle')\n\n# Draw surrounding particles\nfor pos in particle_positions:\n    ax.plot(*pos, 'o', color='blue', markersize=5, alpha=0.7)\n\n# Draw the shell\ncircle_inner = plt.Circle(central_particle, r, color='green', fill=False, linestyle='--', label=f'$r = {r}$')\ncircle_outer = plt.Circle(central_particle, r + dr, color='orange', fill=False, linestyle='--', label=f'$r + \\Delta r = {r + dr}$')\nax.add_artist(circle_inner)\nax.add_artist(circle_outer)\n\n# Annotate particles within the shell\nfor pos in particle_positions:\n    distance = np.linalg.norm(np.array(pos) - np.array(central_particle))\n    if r <= distance < r + dr:\n        ax.plot(*pos, 'o', color='purple', markersize=7)\n\n# Add labels and legend\nax.set_title('Radial Distribution Function Demonstration')\nax.set_xlabel('$x$')\nax.set_ylabel('$y$')\nax.legend()\n\n# Show plot\nplt.show()","visibility":"hide","key":"UdRT4QKeXA"},{"type":"output","id":"VkDISBzxbzP0v24prbbr-","data":[],"visibility":"show","key":"SZCpRmCqJb"}],"data":{"tags":[]},"visibility":"show","key":"GeXepFGuoa"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"The radial distribution function, denoted by ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"wyceMvOzsz"},{"type":"inlineMath","value":"g(r)","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"SxLQoWu43P"},{"type":"text","value":", is a measure of the “structure” of a fluid or solid. It quantifies the average number of particles at a distance ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"PSCCO8n4Cr"},{"type":"inlineMath","value":"r","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"kHwsyLZE7D"},{"type":"text","value":" from a central particle relative to the ideal gas case. The radial distribution function is defined as","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"FoysGiKfLO"}],"key":"yJhY6Dqrr6"},{"type":"math","value":"g(r) = \\frac{\\langle N(r) \\rangle}{4 \\pi r^2 \\Delta r \\rho}","position":{"start":{"line":79,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mo stretchy=\"false\">⟨</mo><mi>N</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">⟩</mo></mrow><mrow><mn>4</mn><mi>π</mi><msup><mi>r</mi><mn>2</mn></msup><mi mathvariant=\"normal\">Δ</mi><mi>r</mi><mi>ρ</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">g(r) = \\frac{\\langle N(r) \\rangle}{4 \\pi r^2 \\Delta r \\rho}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3074em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">ρ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)⟩</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"OGUDyeJNxM"},{"type":"paragraph","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"alR8IKvbpl"},{"type":"inlineMath","value":"\\langle N(r) \\rangle","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">⟨</mo><mi>N</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">⟩</mo></mrow><annotation encoding=\"application/x-tex\">\\langle N(r) \\rangle</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)⟩</span></span></span></span>","key":"KTSuojm7sT"},{"type":"text","value":" is the average number of particles in a shell of radius ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"rEMdZhjCWQ"},{"type":"inlineMath","value":"r","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"AXxomsnpJy"},{"type":"text","value":" and thickness ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"hWP2Cfzglz"},{"type":"inlineMath","value":"\\Delta r","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"MFS1iaw8Br"},{"type":"text","value":" around a central particle, ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"dh9U2GOhpO"},{"type":"inlineMath","value":"\\rho","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding=\"application/x-tex\">\\rho</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ρ</span></span></span></span>","key":"z4Ldj3BnMz"},{"type":"text","value":" is the number density of particles, and ","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"IGL5QEvmQJ"},{"type":"inlineMath","value":"r","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"jgHhS0xrK7"},{"type":"text","value":" is the distance from the central particle. The radial distribution function provides information about the local structure of a system, such as the presence of short-range order, long-range order, or disorder.","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"lKu53j9OMr"}],"key":"xZAUTspEqa"},{"type":"heading","depth":2,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Computing the Radial Distribution Function","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"C1krZZYCyz"}],"identifier":"computing-the-radial-distribution-function","label":"Computing the Radial Distribution Function","html_id":"computing-the-radial-distribution-function","implicit":true,"key":"ITyTPMi0Va"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"To compute the radial distribution function for a given configuration of particles, we need to follow these steps:","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"ykXt4KWPvA"}],"key":"QldXBW31Xh"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":89,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"Compute the distance between all pairs of particles in the system.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"s5U2e3QCTx"}],"key":"yuj48RNx8s"},{"type":"listItem","spread":true,"position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"Bin the distances into radial bins.","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"J7TJLbg7Ro"}],"key":"kkcOFG1YiK"},{"type":"listItem","spread":true,"position":{"start":{"line":91,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"Compute the radial distribution function using the formula given above.","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"Ee9esOOqJV"}],"key":"y8pOwAuSQ3"}],"key":"U4dmlv4XsF"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Let’s consider an example to illustrate how to compute the radial distribution function for a simple system of particles.","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"FGE5m1Ovpi"}],"key":"MsFiqOK87Q"},{"type":"heading","depth":2,"position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"Example: Lennard-Jones Fluid","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"Xxlum2Ku2S"}],"identifier":"example-lennard-jones-fluid","label":"Example: Lennard-Jones Fluid","html_id":"example-lennard-jones-fluid","implicit":true,"key":"IphikjuBkE"},{"type":"image","url":"/lj-1466806cb7408041f45d484330a63099.png","alt":"Lennard-Jones Fluid","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"zzelzatjla","urlSource":"lj.png"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"Consider a three-dimensional Lennard-Jones fluid (","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"hy5dz2Yeuu"},{"type":"inlineMath","value":"\\epsilon = 1","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"TgB2KIOkwD"},{"type":"text","value":", ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"g79Wq8rIjc"},{"type":"inlineMath","value":"\\sigma = 1","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\sigma = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"asvQC0lEMK"},{"type":"text","value":", ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"lCCaAY4YoT"},{"type":"inlineMath","value":"r_c = 2.5","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mi>c</mi></msub><mo>=</mo><mn>2.5</mn></mrow><annotation encoding=\"application/x-tex\">r_c = 2.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.5</span></span></span></span>","key":"CgAjFIkJNO"},{"type":"text","value":") with periodic boundary conditions and ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"lGIceEtVAo"},{"type":"inlineMath","value":"N = 1500","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><mn>1500</mn></mrow><annotation encoding=\"application/x-tex\">N = 1500</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1500</span></span></span></span>","key":"EgBpuNC08g"},{"type":"text","value":" particles in a cubic box of side length ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"V5rRqpTvQV"},{"type":"inlineMath","value":"L = 20","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding=\"application/x-tex\">L = 20</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">20</span></span></span></span>","key":"aLhx8lHfga"},{"type":"text","value":". The final configuration of the particles, after a molecular dynamics simulation at a temperature of ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"Jb0GQGd9Ud"},{"type":"inlineMath","value":"T = 0.5","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">T = 0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"pjA2KbFtgW"},{"type":"text","value":", is given in the file ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"ZYQQ24MGd1"},{"type":"link","url":"https://wustl.instructure.com/courses/141498/files/8808015/download?download_frd=1","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"inlineCode","value":"lj.xyz","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"DmEUQBeDpz"}],"urlSource":"https://wustl.instructure.com/courses/141498/files/8808015/download?download_frd=1","key":"R2O2M2BY2S"},{"type":"text","value":". We want to compute the radial distribution function for this configuration of particles.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"nZGpQIRmAE"}],"key":"CkU4Sp7QPt"},{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Let’s start by loading the configuration of particles from the file ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"lvUkxRDT7m"},{"type":"inlineCode","value":"lj.xyz","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"X1CPWou2tJ"},{"type":"text","value":".","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"EFnhsuh54o"}],"key":"qdKrOrp6Kb"}],"key":"z6yfwpYDgL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load the configuration of particles from the file lj.xyz\nimport numpy as np\n\ndef read_xyz(filename):\n    with open(filename, 'r') as f:\n        lines = f.readlines()\n        n_atoms = int(lines[0])\n        data = np.zeros((n_atoms, 3))\n        for i in range(2, n_atoms + 2):\n            # Skip the first and second columns (id and species) and extract the x, y, z coordinates\n            data[i - 2] = np.array([float(x) for x in lines[i].split()[2:5]])\n    return data\n\n# Load the configuration of particles from the file lj.xyz\nfilename = 'lj.xyz'\npositions = read_xyz(filename)\nn_atoms = len(positions)\nprint(f'Number of particles: {n_atoms}')","key":"Lv10WhSLqD"},{"type":"output","id":"00xpqHX60fiU1UnEt5cfh","data":[],"key":"ga8jBwkv4F"}],"key":"anTNG7CqwJ"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"Now that we have loaded the configuration of particles, we can compute the distance between all pairs of particles in the system.","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"vtl0oN7W4y"}],"key":"snP6goyhvw"}],"key":"PoqFaNXOTT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Compute the distance between all pairs of particles in the system\ndef compute_distance(positions, box_length):\n    n_atoms = len(positions)\n    distances = []\n    for i in range(n_atoms):\n        for j in range(n_atoms):\n            if i >= j:\n                continue\n            dr = positions[i] - positions[j]\n            dr = dr - box_length * np.round(dr / box_length)\n            distance = np.linalg.norm(dr)\n            distances.append(distance)\n    return distances\n\n# Compute the distance between all pairs of particles in the system\nbox_length = 20\ndistances = compute_distance(positions, box_length)\nprint(f'Number of distances: {len(distances)}')\n\n# Compute the statistics of the distances\nprint(f'Minimum distance: {min(distances)}')\nprint(f'Maximum distance: {max(distances)}')\nprint(f'Mean distance: {np.mean(distances)}')\nprint(f'Standard deviation of distance: {np.std(distances)}')","key":"oKKzPSpxnh"},{"type":"output","id":"Ytnhapc6GJbFeSDlp_dy7","data":[],"key":"jsS9La8Qi5"}],"key":"YACoXKnQ5C"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"Next, we need to bin the distances into radial bins. We will use a bin width of ","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"rtLDUBLDNd"},{"type":"text","value":"0.2","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"kdWzzfykGc"},{"type":"text","value":" and a maximum distance of ","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"VWDFWnATDQ"},{"type":"text","value":"10","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"IWJR2g5Ye0"},{"type":"text","value":" for this example.","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"Nu1L283LBR"}],"key":"yVjIxDVnbD"}],"key":"M5le3QaD8M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Bin the distances into radial bins\ndef bin_distances(distances, bin_width, max_distance):\n    bins = np.arange(bin_width, max_distance + bin_width * 2, bin_width)\n    hist, _ = np.histogram(distances, bins=bins)\n    return hist\n\n# Bin the distances into radial bins\nbin_width = 0.01\nmax_distance = 3.5\nhist = bin_distances(distances, bin_width, max_distance)\nprint(f'Number of bins: {len(hist)}')","key":"acNzqyEIUL"},{"type":"output","id":"nQQMnaK6PW6kwQx3QfZHd","data":[],"key":"f1Gk4p9Pr9"}],"key":"L1dAfyBVQR"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"Finally, we can compute the radial distribution function using the formula given above.","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"HzmAHsJvma"}],"key":"VSJWeOhUwG"}],"key":"PToOjGBzNw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def radial_distribution_function(hist, n_atoms, box_length, bin_width):\n    rho = n_atoms / box_length**3\n    r = (np.arange(1, len(hist) + 1) - 0.5) * bin_width\n    shell_volumes = 4 * np.pi * r**2 * bin_width\n    g = hist / (rho * n_atoms * shell_volumes)\n    return r, g\n\n# Compute the radial distribution function\nr, g = radial_distribution_function(hist, n_atoms, box_length, bin_width)","key":"eSoRLUmZQF"},{"type":"output","id":"cfpgBHY687hMMJ-HoZpqy","data":[],"key":"Sbo6Mr4OLC"}],"key":"WVXSeeDcsj"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"Now that we have computed the radial distribution function, we can plot it to visualize the structure of the fluid.","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"bTvp2jkxPJ"}],"key":"l8PkvTUo4I"}],"key":"se35BVu1mM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n# Plot the radial distribution function\nplt.plot(r, g)\nplt.xlabel('r')\nplt.ylabel('g(r)')\nplt.title('Radial Distribution Function')\n\n# Annotate the first peak\nfirst_peak_label = 'First Nearest Neighbor Peak'\nplt.annotate(\n    first_peak_label,\n    xy=(1.2, 3),\n    xytext=(1.5, 4),\n    arrowprops=dict(facecolor='black', shrink=0.05))\n\n# Annotate the second peak\nsecond_peak_label = 'Second Nearest Neighbor Peak'\nplt.annotate(\n    second_peak_label,\n    xy=(2.2, 1.5),\n    xytext=(2.5, 2),\n    arrowprops=dict(facecolor='black', shrink=0.05))\n\n# Annotate the third peak\nthird_peak_label = 'Third Nearest Neighbor Peak'\nplt.annotate(\n    third_peak_label,\n    xy=(3.2, 1),\n    xytext=(3.5, 1.5),\n    arrowprops=dict(facecolor='black', shrink=0.05))\n\n# Horizontal line at g(r) = 1\nplt.axhline(y=1, color='r', linestyle='--')\nplt.text(0, 1.1, 'Ideal Gas', color='red')\n\nplt.show()","visibility":"hide","key":"JId899p0ls"},{"type":"output","id":"BBVCQaNk0NnfUCUdHIPaU","data":[],"visibility":"show","key":"t51xTjhtnW"}],"data":{"tags":[]},"visibility":"show","key":"TTXJA7RJ9V"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"text","value":"Interpretation of the Radial Distribution Function","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"Lr1O8g3paX"}],"identifier":"interpretation-of-the-radial-distribution-function","label":"Interpretation of the Radial Distribution Function","html_id":"interpretation-of-the-radial-distribution-function","implicit":true,"key":"GAChK7jh98"},{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"The radial distribution function provides information about the local structure of a system. Here are some key points to keep in mind when interpreting the radial distribution function:","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"gl10GEcseg"}],"key":"ONYww23F15"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":230,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"inlineMath","value":"g(r) = 1","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">g(r) = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"fDBzAloDAd"},{"type":"text","value":" for an ideal gas, indicating no correlation between particles at different distances.","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"Of8wjlHDcg"}],"key":"wVpxcKAazB"},{"type":"listItem","spread":true,"position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"inlineMath","value":"g(r) > 1","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">g(r) &gt; 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"EHn0u8Ncgg"},{"type":"text","value":" for attractive interactions, indicating clustering of particles at certain distances.","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"OO0iCLvb2V"}],"key":"V1E8hc0IM4"},{"type":"listItem","spread":true,"position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"children":[{"type":"inlineMath","value":"g(r) < 1","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">g(r) &lt; 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"RSVRXMgbnt"},{"type":"text","value":" for repulsive interactions, indicating exclusion of particles at certain distances.","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"y3sdVhErqr"}],"key":"cyNaw6RlgZ"},{"type":"listItem","spread":true,"position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"text","value":"Peaks in ","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"c1Ln0aNmFL"},{"type":"inlineMath","value":"g(r)","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"GEzE0pkXMp"},{"type":"text","value":" correspond to the average number of particles at specific distances from a central particle.","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"mOIXYVRHRW"}],"key":"gDyqJlFZAO"},{"type":"listItem","spread":true,"position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"The first peak in ","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"suUdXYi257"},{"type":"inlineMath","value":"g(r)","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"IejPEI8B5d"},{"type":"text","value":" corresponds to the first nearest neighbor distance, the second peak to the second nearest neighbor distance, and so on.","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"wsJ8yPJB0b"}],"key":"wcKPZ33fPU"},{"type":"listItem","spread":true,"position":{"start":{"line":235,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"The height and width of the peaks in ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"aWBxrSh9TY"},{"type":"inlineMath","value":"g(r)","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"FEWSc7W9iW"},{"type":"text","value":" provide information about the strength and range of interactions between particles. Higher, narrower peaks indicate strong, short-range interactions, while broader peaks indicate weaker, longer-range interactions.","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"Sm55hTpr6N"}],"key":"ethIEdUVcE"}],"key":"mKHoAOvYW0"},{"type":"heading","depth":2,"position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"iqhhtxhdHV"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"HtJX1avgZB"},{"type":"paragraph","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"children":[{"type":"text","value":"In this lecture, we introduced the radial distribution function as a measure of the local structure of a fluid or solid. We discussed how to compute the radial distribution function for a given configuration of particles and interpret the results. The radial distribution function provides valuable insights into the interactions between particles in a system and will helps us understand the structure and properties of bead-spring polymers in the next lecture and project.","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"Fq5iRMiwL5"}],"key":"hio3fdd1Dg"}],"key":"d9nEvYTm7F"}],"key":"xITCGhSyK3"},"references":{"cite":{"order":[],"data":{}}}}